{"Extract_PricebookEntry": {"action": "sfdcDigest","parameters": {"object": "pricebookentry","SFDCtoken": "SFDCtoken","fields": [{"name": "Id"},{"name": "Product2Id"}]}},"Join_CaseAccount": {"action": "augment","parameters": {"right": "Join_AccountOwner","right_select": ["Name","Type","Industry","BillingCountry","BillingState","AccountSource","NumberOfEmployees","AnnualRevenue","OwnerId","Owner.Name","Owner.Role.Name","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId"],"right_key": ["Id"],"left": "compute_CalculatedCaseDuration","left_key": ["AccountId"],"relationship": "Account"}},"Append_User_Queue": {"action": "append","parameters": {"sources": ["Filter_User","Extract_Queue"]}},"Extract_Opportunity": {"action": "sfdcDigest","parameters": {"object": "opportunity","SFDCtoken": "SFDCtoken","fields": [{"name": "Id"},{"name": "AccountId"},{"name": "OwnerId"},{"name": "Name"},{"name": "StageName"},{"name": "LeadSource"},{"name": "IsWon"},{"name": "Type"},{"name": "IsClosed"},{"name": "ForecastCategory"},{"name": "ForecastCategoryName"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "CreatedDate"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "CloseDate"},{"name": "Amount"},{"name": "CreatedById"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "LastModifiedDate"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "LastActivityDate"},{"name": "HasOpportunityLineItem"},{"name": "RecordTypeId"}]}},"Extract_OpportunityAmount": {"action": "sfdcDigest","parameters": {"object": "opportunity","SFDCtoken": "SFDCtoken","fields": [{"name": "Id"},{"name": "Amount"}]}},"Join_LeadOwner": {"action": "augment","parameters": {"right": "User_with_Roles","right_select": ["Name","Username","UserRoleId","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","Role.ParentRole.Name","Role.ParentRole.DeveloperName","Role.RoleNames","Role.RoleNamesPath"],"right_key": ["Id"],"left": "Compute_CurrentDateForLeads","left_key": ["OwnerId"],"relationship": "Owner"}},"Extract_Product": {"action": "sfdcDigest","parameters": {"object": "product2","SFDCtoken": "SFDCtoken","fields": [{"name": "Id"},{"name": "ProductCode"},{"name": "Name"},{"name": "Family"}]}},"Join_LeadOwnerOpportunity": {"action": "augment","parameters": {"right": "Join_OpportunityOwner","right_select": ["Name","StageName","CloseDate","IsWon","Type","IsClosed","LeadSource","ForecastCategory","ForecastCategoryName","CreatedDate","AccountId","OwnerId","Owner.Name","Owner.Role.Name","Owner.Role.DeveloperName","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId","OpportunityAge","DaysSinceLastActivity"],"right_key": ["Id"],"left": "Join_LeadOwner","left_key": ["ConvertedOpportunityId"],"relationship": "ConvertedOpportunity"}},"Compute_CurrentDateForLeads": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"format": "yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","name": "CurrentDate","saqlExpression": "now()","label": "CurrentDate","type": "Date"}],"source": "Extract_Lead"}},"Extract_User": {"action": "sfdcDigest","parameters": {"object": "user","SFDCtoken": "SFDCtoken","fields": [{"name": "Id"},{"name": "Username"},{"name": "Name"},{"name": "FirstName"},{"name": "LastName"},{"name": "UserRoleId"},{"name": "UserType"},{"name": "IsActive"}]}},"Join_ActivityOwner_Product_Opp_User": {"action": "augment","parameters": {"right": "Append_User_Queue","right_select": ["Name"],"right_key": ["Id"],"left": "Join_ActivityOwner_Product_Opp","left_key": ["OwnerId"],"relationship": "AssignedTo"}},"Extract_Case": {"action": "sfdcDigest","parameters": {"object": "case","fields": [{"name": "AccountId"},{"name": "ContactId"},{"name": "OwnerId"},{"name": "Id"},{"name": "IsClosed"},{"name": "Origin"},{"name": "Type"},{"name": "Subject"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "LastModifiedDate"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "CreatedDate"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "ClosedDate"},{"name": "IsEscalated"},{"name": "Status"},{"name": "CaseNumber"}]}},"Extract_OpportunityStage": {"action": "sfdcDigest","parameters": {"object": "opportunitystage","fields": [{"name": "IsClosed"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "CreatedDate"},{"name": "Description"},{"name": "ForecastCategory"},{"name": "ForecastCategoryName"},{"name": "IsActive"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "LastModifiedDate"},{"name": "MasterLabel"},{"name": "Id"},{"name": "DefaultProbability"},{"name": "SortOrder"},{"name": "SystemModstamp"},{"name": "IsWon"}]}},"Join_OpportunityStage_Previous_with_Opp": {"action": "augment","parameters": {"right": "Join_OpportunityOwner","right_select": ["Name","Type","IsWon","IsClosed","OwnerId","AccountId","CloseDate","StageName","LeadSource","ForecastCategoryName","Account.Name","Account.Type","Account.Industry","Account.AccountSource","Account.BillingState","Account.BillingCountry","Account.OwnerId","Account.Owner.Name","Owner.Name","Owner.Role.RoleNames","Owner.Role.Name","Owner.Role.DeveloperName","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId","Owner.Role.ParentRole.Name","Owner.Role.ParentRole.DeveloperName","RecordTypeId","RecordType.Name"],"right_key": ["Id"],"left": "Join_OpportunityStage_Previous","left_key": ["OpportunityId"],"relationship": "Opportunity"}},"Join_OpportunityStage_Previous_with_Opp_Amount": {"action": "augment","parameters": {"right": "Extract_OpportunityAmount","right_select": ["Amount"],"right_key": ["Id"],"left": "Join_OpportunityStage_Previous_with_Opp","left_key": ["OpportunityId"],"relationship": "Opportunity"}},"Register_PlainQuota": {"action": "sfdcRegister","parameters": {"alias": "plain_quota2","name": "Quota","SFDCtoken": "SFDCtoken","source": "Extract_Quota"}},"Join_OpportunityLineItemPricebookEntryProduct": {"action": "augment","parameters": {"right": "Extract_Product","right_select": ["ProductCode","Name","Family"],"right_key": ["Id"],"left": "Join_OpportunityLineItemPricebookEntry","left_key": ["Pricebook.Product2Id"],"relationship": "Product"}},"Compute_AdditionalFieldsForLead": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"defaultValue": "0","precision": 18,"name": "LeadAge","saqlExpression": "case when ('IsConverted' == \"false\") then daysBetween(toDate(CreatedDate_sec_epoch), now())  else daysBetween(toDate(ConvertedDate_day_epoch), toDate(CreatedDate_day_epoch))  end","scale": 2,"label": "Lead Age in Days","type": "Numeric"},{"defaultValue": "0","precision": 18,"name": "OpportunityAge","saqlExpression": "case when ('ConvertedOpportunity.Name' is null) then 0 when ('ConvertedOpportunity.IsClosed' == \"false\") then ('CurrentDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400  else ('ConvertedOpportunity.CloseDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400 end","scale": 2,"label": "Total Opportunity Age","type": "Numeric"}],"source": "Join_LeadOwnerOpportunityAccount"}},"Extract_Queue": {"action": "sfdcDigest","parameters": {"object": "group","complexFilterConditions": "Type = 'Queue'","fields": [{"name": "Id"},{"name": "Name"},{"name": "Type"}]}},"Register_OpportunityProducts": {"action": "sfdcRegister","parameters": {"alias": "opportunity_products1","name": "Oppty Products","SFDCtoken": "SFDCtoken","rowLevelSecurityFilter": "'Opportunity.Owner.Role.Roles' == \"$User.UserRoleId\" || 'Opportunity.OwnerId' == \"$User.Id\" || 'Opportunity.Account.OwnerId' == \"$User.Id\"","source": "Filter_Opportunity_Products"}},"Extract_Lead": {"action": "sfdcDigest","parameters": {"object": "lead","SFDCtoken": "SFDCtoken","fields": [{"name": "Id"},{"name": "Name"},{"name": "OwnerId"},{"defaultValue": "N/A","name": "Company"},{"name": "ConvertedAccountId"},{"name": "ConvertedContactId"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "ConvertedDate"},{"name": "ConvertedOpportunityId"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "CreatedDate"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "LastModifiedDate"},{"name": "IsConverted"},{"name": "IsUnreadByOwner"},{"defaultValue": "N/A","name": "Status"},{"defaultValue": "N/A","name": "LeadSource"},{"defaultValue": "N/A","name": "Rating"},{"defaultValue": "N/A","name": "Industry"},{"defaultValue": "N/A","name": "Country"}]}},"Append_LineItems": {"action": "append","parameters": {"sources": ["Extract_OpportunityLineItem","Compute_Opportunities_No_Products_Id"]}},"Register_UserManager": {"action": "sfdcRegister","parameters": {"alias": "user2","name": "Users","SFDCtoken": "SFDCtoken","rowLevelSecurityFilter": "'Role.Roles' == \"$User.UserRoleId\" || 'Id' == \"$User.Id\"","source": "User_with_Roles"}},"Join_OpportunityStage": {"action": "augment","parameters": {"right": "Extract_OpportunityStage","right_select": ["IsClosed","IsWon"],"right_key": ["MasterLabel"],"left": "Add_Fields_to_OpportunityHistory","left_key": ["StageName"],"relationship": "Stage"}},"Join_ActivityOwner_Product": {"action": "augment","parameters": {"right": "Join_OpportunityOpportunityLineItemPricebookEntryProduct","right_select": ["Product.Family","Product.Name"],"right_key": ["OpportunityId"],"left": "Join_ActivityOwner","left_key": ["WhatId"],"operation": "LookupMultiValue","relationship": "Opportunity"}},"Register_Activity": {"action": "sfdcRegister","parameters": {"alias": "activity","name": "Activities","SFDCtoken": "SFDCtoken","rowLevelSecurityFilter": "'Owner.Role.Roles' == \"$User.UserRoleId\" || 'OwnerId' == \"$User.Id\"","source": "Filter_Activity"}},"Join_ActivityOwner_Product_Opp": {"action": "augment","parameters": {"right": "Join_OpportunityOwner","right_select": ["Id","Name","Type","OwnerId","IsWon","IsClosed","AccountId","CloseDate","StageName","CreatedDate","LeadSource","ForecastCategoryName","Account.Name","Account.Type","Account.Industry","Account.AccountSource","Account.BillingCountry","Account.BillingState","Account.OwnerId","RecordTypeId","RecordType.Name","OpportunityAge","DaysSinceLastActivity"],"right_key": ["Id"],"left": "Join_ActivityOwner_Product","left_key": ["WhatId"],"relationship": "Opportunity"}},"Register_UserRole": {"action": "sfdcRegister","parameters": {"alias": "user_role2","name": "Roles","SFDCtoken": "SFDCtoken","source": "Flatten_ParentName"}},"compute_CurrentDateForCase": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"format": "yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","name": "CurrentDate","saqlExpression": "now()","label": "CurrentDate","type": "Date"}],"source": "Extract_Case"}},"Filter_Out_Final_Updates": {"action": "filter","parameters": {"filter": "IsLastUpdate:EQ:1","source": "Add_Fields_to_OpportunityHistory"}},"Join_OpportunityOpportunityStage": {"action": "augment","parameters": {"right": "Extract_OpportunityStage","right_select": ["SortOrder","DefaultProbability"],"right_key": ["MasterLabel"],"left": "Add_Fields_To_Opportunity","left_key": ["StageName"],"relationship": "Stage"}},"Augment_ParentName": {"action": "augment","parameters": {"right": "Extract_UserRole","right_select": ["Name","DeveloperName"],"right_key": ["Id"],"left": "Flatten_UserRole","left_key": ["ParentRoleId"],"relationship": "ParentRole"}},"Extract_OpportunityHistory": {"action": "sfdcDigest","parameters": {"object": "opportunityhistory","fields": [{"name": "Amount"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "CloseDate"},{"name": "CreatedById"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "CreatedDate"},{"name": "ForecastCategory"},{"name": "Id"},{"name": "IsDeleted"},{"name": "OpportunityId"},{"name": "StageName"}]}},"Extract_OpportunityLineItem": {"action": "sfdcDigest","parameters": {"object": "opportunitylineitem","SFDCtoken": "SFDCtoken","fields": [{"name": "OpportunityId"},{"name": "ProductCode"},{"name": "ListPrice"},{"name": "Quantity"},{"name": "TotalPrice"},{"name": "PricebookEntryId"}]}},"Filter_Pipeline_Trending": {"action": "filter","parameters": {"filter": "CustomFilter:EQ:true","source": "Pipeline_Trending_Custom_Filter_Flag"}},"Filter_Opportunity_Products": {"action": "filter","parameters": {"filter": "CustomFilter:EQ:true","source": "Opportunity_Products_Custom_Filter_Flag"}},"Register_Pipeline_Trending": {"action": "sfdcRegister","parameters": {"alias": "pipeline_trending2","name": "Pipeline Trending","rowLevelSecurityFilter": "'Opportunity.Owner.Role.Roles' == \"$User.UserRoleId\" || 'Opportunity.OwnerId' == \"$User.Id\" || 'Opportunity.Account.OwnerId' == \"$User.Id\"","source": "Filter_Pipeline_Trending"}},"Opportunities_No_Products": {"action": "filter","parameters": {"filter": "HasOpportunityLineItem:EQ:false","source": "Add_Fields_To_Opportunity"}},"Join_ActivityOwner": {"action": "augment","parameters": {"right": "User_with_Roles","right_select": ["Name","Username","UserRoleId","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","Role.ParentRole.Name","Role.ParentRole.DeveloperName","Role.RoleNames","Role.RoleNamesPath"],"right_key": ["Id"],"left": "Append_TaskEvent","left_key": ["OwnerId"],"relationship": "Owner"}},"Discount_Field": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"precision": 7,"name": "Discount_Percent","saqlExpression": "1-(('TotalPrice')/('ListPrice' * 'Quantity'))","scale": 6,"type": "Numeric"}],"source": "Append_LineItems"}},"Filter_Opportunity": {"action": "filter","parameters": {"filter": "CustomFilter:EQ:true","source": "Opportunity_Custom_Filter_Flag"}},"Register_Opportunity": {"action": "sfdcRegister","parameters": {"alias": "opportunity2","name": "Opportunities","SFDCtoken": "SFDCtoken","rowLevelSecurityFilter": "'Owner.Role.Roles' == \"$User.UserRoleId\" || 'OwnerId' == \"$User.Id\" || 'Account.OwnerId' == \"$User.Id\"","source": "Filter_Opportunity"}},"Filter_Activity": {"action": "filter","parameters": {"filter": "CustomFilter:EQ:true","source": "Activity_Custom_Filter_Flag"}},"Join_OpportunityLineItemPricebookEntry": {"action": "augment","parameters": {"right": "Extract_PricebookEntry","right_select": ["Product2Id"],"right_key": ["Id"],"left": "Discount_Field","left_key": ["PricebookEntryId"],"relationship": "Pricebook"}},"Extract_Task": {"action": "sfdcDigest","parameters": {"object": "task","fields": [{"name": "Id"},{"name": "CallDurationInSeconds"},{"name": "CallDisposition"},{"name": "CallType"},{"name": "OwnerId"},{"name": "Status"},{"name": "Priority"},{"name": "IsClosed"},{"name": "TaskSubtype"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "CreatedDate"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "ActivityDate"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "LastModifiedDate"},{"name": "Subject"},{"name": "WhatId"},{"name": "AccountId"}]}},"Join_AccountOwner": {"action": "augment","parameters": {"right": "User_with_Roles","right_select": ["Name","Username","UserRoleId","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","Role.ParentRole.Name","Role.ParentRole.DeveloperName","Role.RoleNames","Role.RoleNamesPath"],"right_key": ["Id"],"left": "Extract_Account","left_key": ["OwnerId"],"relationship": "Owner"}},"Join_Time_In_Current_Stage_to_Opportunity": {"action": "augment","parameters": {"right": "Filter_Out_Final_Updates","right_select": ["Duration"],"right_key": ["OpportunityId"],"left": "Join_OpportunityRecordType","left_key": ["Id"],"relationship": "Time_In_Current_Stage"}},"Filter_WonOppty": {"action": "filter","parameters": {"filter": "IsWon:EQ:true","source": "Join_OpportunityAccount"}},"Append_TaskEvent": {"action": "append","parameters": {"sources": ["Add_Fields_To_Task","Add_Fields_To_Event"]}},"Add_Fields_to_OpportunityHistory": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"defaultValue": "\"1\"","name": "Stage_isUpdated","saqlExpression": "case when 'StageName' == 'StageNamePrev' then \"0\" else \"1\" end","type": "Text"},{"defaultValue": "\"1\"","name": "CloseDate_isUpdated","saqlExpression": "case when 'CloseDatePrev' == 'CloseDate' then \"0\" else \"1\" end","type": "Text"},{"defaultValue": "\"1\"","name": "Amount_isUpdated","saqlExpression": "case when 'AmountPrev' == 'Amount' then \"0\" else \"1\" end","type": "Text"},{"name": "IsLastUpdate","saqlExpression": "case when 'ValidToDate' == \"3000-01-01T00:00:00.000Z\" then \"1\" else \"0\" end","label": "IsLastUpdate","type": "Text"},{"precision": 8,"name": "IsPushed","saqlExpression": "case when ('CloseDatePrev' is not null) && ('CloseDatePrev' < 'CloseDate') then 1 else 0 end","scale": 0,"type": "Numeric"},{"precision": 8,"name": "IsPulled","saqlExpression": "case when ('CloseDatePrev' is not null) && ('CloseDatePrev' > 'CloseDate') then 1 else 0 end","scale": 0,"type": "Numeric"},{"precision": 18,"name": "Duration","saqlExpression": "case when 'ValidToDate' == \"3000-01-01T00:00:00.000Z\" then     date_diff(\"second\",toDate('ValidFromDate',\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\"), now())     else     date_diff(\"second\",toDate('ValidFromDate',\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\"), toDate('ValidToDate',\"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\"))     end","scale": 0,"label": "Duration","type": "Numeric"}],"source": "Compute_Historical_Trending_Fields"}},"Register_Lead": {"action": "sfdcRegister","parameters": {"alias": "lead","name": "Leads","SFDCtoken": "SFDCtoken","rowLevelSecurityFilter": "'Owner.Role.Roles' == \"$User.UserRoleId\" || 'OwnerId' == \"$User.Id\"","source": "Compute_AdditionalFieldsForLead"}},"Register_Account": {"action": "sfdcRegister","parameters": {"alias": "account1","name": "Accounts","SFDCtoken": "SFDCtoken","source": "Filter_Account"}},"Join_OpportunityOwner": {"action": "augment","parameters": {"right": "User_with_Roles","right_select": ["Name","Username","UserRoleId","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","Role.ParentRole.Name","Role.ParentRole.DeveloperName","Role.RoleNames","Role.RoleNamesPath"],"right_key": ["Id"],"left": "Join_OpportunityAccount","left_key": ["OwnerId"],"relationship": "Owner"}},"Join_CaseAccount_Oppty": {"action": "augment","parameters": {"right": "Filter_WonOppty","right_select": ["Amount"],"right_key": ["AccountId"],"left": "Join_CaseAccount","left_key": ["AccountId"],"operation": "LookupMultiValue","relationship": "Opportunity"}},"Add_Fields_To_Event": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "CallDisposition","saqlExpression": "\"Event\"","label": "CallDisposition","type": "Text"},{"name": "CallType","saqlExpression": "\"Event\"","label": "CallType","type": "Text"},{"name": "Status","saqlExpression": "\"Event\"","label": "Status","type": "Text"},{"name": "Priority","saqlExpression": "\"Event\"","label": "Priority","type": "Text"},{"name": "TaskSubtype","saqlExpression": "EventSubtype","label": "TaskSubtype","type": "Text"},{"defaultValue": "0","precision": 8,"name": "CallDurationInSeconds","saqlExpression": "0","scale": 0,"label": "CallDurationInSeconds","type": "Numeric"},{"name": "IsClosed","saqlExpression": "case when daysBetween(toDate(ActivityDate, \"yyyy-MM-dd\"), now()) >= 0 then \"true\" else \"false\" end","label": "IsClosed","type": "Text"}],"source": "Extract_Event"}},"Join_ActivityOwner_Product_Opp_User_Account": {"action": "augment","parameters": {"right": "Join_AccountOwner","right_select": ["Name","Type","Industry","BillingCountry","BillingState","AccountSource","NumberOfEmployees","AnnualRevenue","OwnerId","Owner.Name","Owner.Role.Name","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId"],"right_key": ["Id"],"left": "Join_ActivityOwner_Product_Opp_User","left_key": ["AccountId"],"relationship": "Account"}},"Account_Custom_Filter_Flag": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "CustomFilter","saqlExpression": "\"true\"","type": "Text"}],"source": "Join_AccountOwner"}},"Join_OpportunityAccount": {"action": "augment","parameters": {"right": "Join_AccountOwner","right_select": ["Name","Type","Industry","BillingCountry","BillingState","AccountSource","NumberOfEmployees","AnnualRevenue","OwnerId","Owner.Name","Owner.Role.Name","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId"],"right_key": ["Id"],"left": "Join_Time_In_Current_Stage_to_Opportunity","left_key": ["AccountId"],"relationship": "Account"}},"Register_QuotaWithRoles": {"action": "sfdcRegister","parameters": {"alias": "quota2","name": "User Allocation","SFDCtoken": "SFDCtoken","source": "Join_Quota_User"}},"compute_CalculatedCaseDuration": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"defaultValue": "0","precision": 18,"name": "DurationCalculatedField","saqlExpression": "case  when ('IsClosed' == \"true\") then ('ClosedDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400   else ('CurrentDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400  end","scale": 2,"label": "Case Duration","type": "Numeric"}],"source": "compute_CurrentDateForCase"}},"Filter_User": {"action": "filter","parameters": {"filter": "UserType:EQ:Standard|PowerPartner","source": "Extract_User"}},"Filter_Account": {"action": "filter","parameters": {"filter": "CustomFilter:EQ:true","source": "Account_Custom_Filter_Flag"}},"Join_OpportunityRecordType": {"action": "augment","parameters": {"right": "Extract_RecordTypes","right_select": ["Name"],"right_key": ["Id"],"left": "Join_OpportunityOpportunityStage","left_key": ["RecordTypeId"],"relationship": "RecordType"}},"Opportunity_Custom_Filter_Flag": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "CustomFilter","saqlExpression": "\"true\"","type": "Text"}],"source": "Join_OpportunityOwner_Product"}},"Compute_Opportunities_No_Products": {"action": "computeExpression","parameters": {"computedFields": [{"name": "OpportunityId","saqlExpression": "Id","label": "OpportunityId","type": "Text"},{"name": "ProductCode","saqlExpression": "\"N/A\"","label": "ProductCode","type": "Text"},{"precision": 18,"name": "ListPrice","saqlExpression": "Amount","scale": 2,"label": "ListPrice","type": "Numeric"},{"precision": 18,"name": "Quantity","saqlExpression": "1","scale": 2,"label": "Quantity","type": "Numeric"},{"precision": 18,"name": "TotalPrice","saqlExpression": "Amount","scale": 2,"label": "Total Price","type": "Numeric"},{"name": "PricebookEntryId","saqlExpression": "Id","label": "PricebookEntryId","type": "Text"}],"source": "Opportunities_No_Products"}},"Join_LeadOwnerOpportunityAccount": {"action": "augment","parameters": {"right": "Join_AccountOwner","right_select": ["Name","Type","Industry","BillingCountry","BillingState","AccountSource","NumberOfEmployees","AnnualRevenue","OwnerId","Owner.Name","Owner.Role.Name","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId"],"right_key": ["Id"],"left": "Join_LeadOwnerOpportunity","left_key": ["ConvertedAccountId"],"relationship": "ConvertedAccount"}},"Activity_Custom_Filter_Flag": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "CustomFilter","saqlExpression": "\"true\"","type": "Text"}],"source": "Join_ActivityOwner_Product_Opp_User_Account"}},"Join_OpportunityStage_Previous_with_Opp_Amount_Product": {"action": "augment","parameters": {"right": "Join_OpportunityOpportunityLineItemPricebookEntryProduct","right_select": ["Product.Family","Product.Name"],"right_key": ["OpportunityId"],"left": "Join_OpportunityStage_Previous_with_Opp_Amount","left_key": ["OpportunityId"],"operation": "LookupMultiValue","relationship": "Opportunity"}},"Compute_Historical_Trending_Fields": {"action": "computeRelative","parameters": {"partitionBy": ["OpportunityId"],"orderBy": [{"name": "CreatedDate","direction": "asc"}],"source": "Extract_OpportunityHistory","computedFields": [{"expression": {"sourceField": "CreatedDate","default": "current()","offset": "first()"},"name": "OpportunityCreatedDate","description": "Opportunity Created Date","label": "OpportunityCreatedDate"},{"expression": {"sourceField": "CreatedDate","default": "3000-01-01T00:00:00.000Z","offset": "next()"},"name": "ValidToDate","description": "ValidToDate","label": "ValidToDate"},{"expression": {"sourceField": "CreatedDate","default": "current()","offset": "current()"},"name": "ValidFromDate","description": "ValidFromDate","label": "ValidFromDate"},{"expression": {"sourceField": "Amount","default": "0","offset": "previous()"},"name": "AmountPrev","description": "AmountPrev","label": "AmountPrev"},{"expression": {"sourceField": "StageName","default": null,"offset": "previous()"},"name": "StageNamePrev","description": "Previous Stage Name","label": "Prev Stage Name"},{"expression": {"sourceField": "ForecastCategory","default": null,"offset": "previous()"},"name": "ForecastCategoryPrev","description": "ForecastCategoryPrev","label": "ForecastCategoryPrev"},{"expression": {"sourceField": "CloseDate","default": "1970-01-01","offset": "previous()"},"name": "CloseDatePrev","description": "Previous Close Date","label": "Prev Close Date"},{"expression": {"sourceField": "CreatedDate","default": null,"offset": "previous()"},"name": "CreatedDatePrev","description": "Previous Created Date","label": "Prev CreatedDate"}]}},"Extract_RecordTypes": {"action": "sfdcDigest","parameters": {"object": "recordtype","fields": [{"name": "Name"},{"name": "Id"}]}},"Flatten_ParentName": {"action": "flatten","parameters": {"parent_field": "ParentRole.DeveloperName","multi_field": "RoleNames","path_field": "RoleNamesPath","self_field": "DeveloperName","source": "Augment_ParentName"}},"Join_Quota_User": {"action": "augment","parameters": {"right": "User_with_Roles","right_select": ["Id","Name","Username","UserRoleId","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","Role.ParentRole.Name","Role.ParentRole.DeveloperName","Role.RoleNames","Role.RoleNamesPath"],"right_key": ["Username"],"left": "Extract_Quota","left_key": ["Username"],"relationship": "User"}},"Extract_CampaignMember": {"action": "sfdcDigest","parameters": {"object": "campaignmember","SFDCtoken": "SFDCtoken","fields": [{"name": "Id"},{"name": "Name"},{"name": "FirstRespondedDate"},{"name": "Status"}]}},"Extract_Account": {"action": "sfdcDigest","parameters": {"object": "account","SFDCtoken": "SFDCtoken","fields": [{"name": "Id"},{"name": "Name"},{"name": "OwnerId"},{"name": "NumberOfEmployees"},{"name": "AnnualRevenue"},{"name": "AccountSource"},{"name": "Type"},{"name": "Industry"},{"name": "BillingCountry"},{"name": "BillingState"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "CreatedDate"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "LastModifiedDate"}]}},"Compute_Opportunities_No_Products_Id": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "Id","saqlExpression": "\"N/A\"","label": "Id","type": "Text"}],"source": "Compute_Opportunities_No_Products"}},"Join_OpportunityOpportunityLineItemPricebookEntryProduct": {"action": "augment","parameters": {"right": "Join_OpportunityOwner","right_select": ["Name","StageName","CloseDate","IsWon","Type","IsClosed","LeadSource","ForecastCategory","ForecastCategoryName","CreatedDate","AccountId","Account.Name","Account.OwnerId","Account.Type","Account.Industry","Account.BillingCountry","Account.BillingState","Account.AccountSource","Account.NumberOfEmployees","Account.AnnualRevenue","Account.Owner.Name","Account.Owner.Role.Name","Account.Owner.Role.Roles","Account.Owner.Role.RolePath","OwnerId","Owner.Name","Owner.Role.Name","Owner.Role.DeveloperName","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId","RecordTypeId","RecordType.Name","OpportunityAge","DaysSinceLastActivity"],"right_key": ["Id"],"left": "Join_OpportunityLineItemPricebookEntryProduct","left_key": ["OpportunityId"],"relationship": "Opportunity"}},"Extract_Quota": {"action": "edgemart","parameters": {"alias": "plain_quota2"}},"Add_Fields_To_Task": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "EventSubtype","saqlExpression": "TaskSubtype","label": "EventSubtype","type": "Text"},{"defaultValue": "0","precision": 8,"name": "DurationInMinutes","saqlExpression": "0","scale": 0,"label": "DurationInMinutes","type": "Numeric"}],"source": "Extract_Task"}},"Extract_UserRole": {"action": "sfdcDigest","parameters": {"object": "userrole","SFDCtoken": "SFDCtoken","fields": [{"name": "Id"},{"name": "Name"},{"name": "DeveloperName"},{"name": "ParentRoleId"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "LastModifiedDate"},{"name": "LastModifiedById"},{"name": "SystemModstamp"}]}},"User_with_Roles": {"action": "augment","parameters": {"right": "Flatten_ParentName","right_select": ["Name","DeveloperName","Roles","RolePath","ParentRoleId","RoleNames","RoleNamesPath","ParentRole.Name","ParentRole.DeveloperName"],"right_key": ["Id"],"left": "Append_User_Queue","left_key": ["UserRoleId"],"relationship": "Role"}},"Pipeline_Trending_Custom_Filter_Flag": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "CustomFilter","saqlExpression": "\"true\"","type": "Text"}],"source": "Join_OpportunityStage_Previous_with_Opp_Amount_Product"}},"Join_OpportunityOwner_Product": {"action": "augment","parameters": {"right": "Join_OpportunityOpportunityLineItemPricebookEntryProduct","right_select": ["Product.Family","Product.Name"],"right_key": ["OpportunityId"],"left": "Join_OpportunityOwner","left_key": ["Id"],"operation": "LookupMultiValue","relationship": "Product"}},"Add_Fields_To_Opportunity": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"precision": 8,"name": "DaysSinceLastActivity","saqlExpression": "case    when LastActivityDate is null      then daysBetween(toDate(substr(LastModifiedDate, 1, 10), \"yyyy-MM-dd\"), now())   when LastModifiedDate > LastActivityDate     then daysBetween(toDate(substr(LastModifiedDate, 1, 10), \"yyyy-MM-dd\"), now())   else daysBetween(toDate(substr(LastActivityDate, 1, 10), \"yyyy-MM-dd\"), now()) end","scale": 0,"label": "Days Since Last Activity","type": "Numeric"},{"precision": 8,"name": "OpportunityAge","saqlExpression": "case    when IsClosed == \"false\"     then daysBetween(toDate(substr(CreatedDate, 1, 10), \"yyyy-MM-dd\"), now())     else daysBetween(toDate(substr(CreatedDate, 1, 10), \"yyyy-MM-dd\"),toDate(substr(CloseDate, 1, 10), \"yyyy-MM-dd\"))     end","scale": 0,"label": "Opportunity Age","type": "Numeric"}],"source": "Extract_Opportunity"}},"Extract_Event": {"action": "sfdcDigest","parameters": {"object": "event","fields": [{"name": "OwnerId"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "CreatedDate"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "LastModifiedDate"},{"fiscalMonthOffset": 0,"firstDayOfWeek": 0,"name": "ActivityDate"},{"name": "Subject"},{"name": "DurationInMinutes"},{"name": "EventSubtype"},{"name": "WhatId"},{"name": "AccountId"}]}},"Flatten_UserRole": {"action": "flatten","parameters": {"parent_field": "ParentRoleId","multi_field": "Roles","path_field": "RolePath","self_field": "Id","source": "Extract_UserRole"}},"Opportunity_Products_Custom_Filter_Flag": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "CustomFilter","saqlExpression": "\"true\"","type": "Text"}],"source": "Join_OpportunityOpportunityLineItemPricebookEntryProduct"}},"Register_Case": {"action": "sfdcRegister","parameters": {"alias": "case","name": "Cases","SFDCtoken": "SFDCtoken","source": "Join_CaseAccount_Oppty"}},"Join_OpportunityStage_Previous": {"action": "augment","parameters": {"right": "Extract_OpportunityStage","right_select": ["IsClosed","IsWon"],"right_key": ["MasterLabel"],"left": "Join_OpportunityStage","left_key": ["StageNamePrev"],"relationship": "StagePrev"}}}
