{
    "Join_CaseHistory_OldOwner":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"compute_CaseHistory_OldNewStatus",
            "left_key":[
                "OldOwner"
            ],
            "right_select":[
                "CallCenterId",
                "Name",
                "Id",
                "Role.Name",
                "Type"
            ],
            "right":"Join_CaseHistory_Queue_User_UserRole",
            "relationship":"OldOwner"
        }
    },
    "Join_ServiceCaseServiceTask":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "WhatId"
            ],
            "left":"Join_CaseAccount",
            "left_key":[
                "Id"
            ],
            "right_select":[
                "ActivityLastModifiedDate"
            ],
            "right":"Compute_Extract_Task",
            "relationship":"Task"
        }
    },
    "Extract_Contact":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"Name"
                },
                {
                    "name":"Id"
                }
            ],
            "object":"Contact"
        }
    },
    "Extract_Opportunity":{
        "action":"sfdcDigest",
        "parameters":{
            "SFDCtoken":"SFDCtoken",
            "fields":[
                {
                    "name":"Id"
                },
                {
                    "name":"AccountId"
                },
                {
                    "name":"OwnerId"
                },
                {
                    "name":"Name"
                },
                {
                    "defaultValue":"N/A",
                    "name":"StageName"
                },
                {
                    "defaultValue":"N/A",
                    "name":"LeadSource"
                },
                {
                    "name":"IsWon"
                },
                {
                    "name":"IsClosed"
                },
                {
                    "defaultValue":"N/A",
                    "name":"ForecastCategory"
                },
                {
                    "defaultValue":"N/A",
                    "name":"ForecastCategoryName"
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"CreatedDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"CloseDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "name":"Amount"
                },
                {
                    "name":"CreatedById"
                },
                {
                    "name":"RecordTypeId"
                }
            ],
            "object":"Opportunity"
        }
    },
    "Join_LiveChatTranscript_Case_NoCSAT":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Join_LiveChatTranscript_User",
            "left_key":[
                "CaseId"
            ],
            "right_select":[
                "Origin",
                "Reason",
                "Type",
                "IsClosed",
                "ClosedDate",
                "CreatedDate",
                "Type_of_Support__c",
                "Status",
                "Product_Family_KB__c",
                "Priority",
                "CaseNumber",
                "Account.Name",
                "Account.Id",
                "Duration__c",
                "Role.Name",
                "CurrentDate",
                "RecordType.Name"
            ],
            "right":"Join_CaseAccountContactUserUserRoleRecordType",
            "relationship":"Case"
        }
    },
    "Extract_Knowledge_kav_online":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"Id"
                },
                {
                    "name":"ArticleNumber"
                },
                {
                    "name":"CreatedById"
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"CreatedDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "name":"OwnerId"
                },
                {
                    "name":"PublishStatus"
                },
                {
                    "name":"IsLatestVersion"
                },
                {
                    "name":"IsVisibleInApp"
                },
                {
                    "name":"IsVisibleInCsp"
                },
                {
                    "name":"IsVisibleInPkb"
                },
                {
                    "name":"IsVisibleInPrm"
                },
                {
                    "name":"KnowledgeArticleId"
                },
                {
                    "name":"Title"
                },
                {
                    "name":"VersionNumber",
                    "type":"Text"
                }
            ],
            "complexFilterConditions":"language = 'en_US' and PublishStatus='Online'",
            "object":"KCSArticle__kav"
        }
    },
    "Extract_ServiceChannel":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"DeveloperName"
                },
                {
                    "name":"MasterLabel"
                },
                {
                    "name":"Id"
                }
            ],
            "object":"ServiceChannel"
        }
    },
    "Handle_Only_Activities":{
        "action":"computeExpression",
        "parameters":{
            "source":"Join_ActivityOwner_Case",
            "computedFields":[
                {
                    "name":"IsActivity",
                    "saqlExpression":"case when 'Case.Id' is null then \"No\" else \"Yes\" end",
                    "label":"Is Activity",
                    "type":"Text"
                },
                {
                    "name":"IsCall",
                    "saqlExpression":"case when CallDurationInSeconds > 0 then \"Yes\" else \"No\" end",
                    "label":"Is Call",
                    "type":"Text"
                },
                {
                    "name":"ActivityIsClosed",
                    "saqlExpression":"case when ('Type' == \"Task\" && 'IsClosed' == \"true\") ||  ('Case.CurrentDate_sec_epoch' > 'EndDateTime_sec_epoch') then \"Completed\" when ('Type' == \"Task\" && 'IsClosed' == \"false\") then \"Open\" else \"Open\" end",
                    "label":"Activity Is Closed",
                    "type":"Text"
                }
            ],
            "mergeWithSource":true
        }
    },
    "Join_CaseAccountContactUserUserRoleCaseArticle":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "CaseId"
            ],
            "left":"Join_CaseAccountContactUserUserRole",
            "left_key":[
                "Id"
            ],
            "right_select":[
                "ArticleVersionNumber",
                "CaseId",
                "CreatedDate",
                "User.Name"
            ],
            "right":"Join_CaseArticleKnowledge_User",
            "relationship":"CaseArticle"
        }
    },
    "Join_CaseAccountContactUserUserRoleRecordType":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Handle_Null_Attached_Articles",
            "left_key":[
                "RecordTypeId"
            ],
            "right_select":[
                "Name"
            ],
            "right":"Extract_RecordTypes",
            "relationship":"RecordType"
        }
    },
    "Join_ServicePresenceUser":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Extract_UserServicePresence",
            "left_key":[
                "UserId"
            ],
            "right_select":[
                "Name"
            ],
            "right":"Extract_User",
            "relationship":"UserId"
        }
    },
    "Extract_Case":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"CSAT__c",
                    "type":"Text"
                },
                {
                    "name":"Duration__c"
                },
                {
                    "name":"AccountId"
                },
                {
                    "name":"ContactId"
                },
                {
                    "name":"OwnerId"
                },
                {
                    "name":"Id"
                },
                {
                    "defaultValue":"N/A",
                    "name":"Origin"
                },
                {
                    "defaultValue":"N/A",
                    "name":"Reason"
                },
                {
                    "defaultValue":"N/A",
                    "name":"Type"
                },
                {
                    "name":"IsClosed"
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"ClosedDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"CreatedDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"LastModifiedDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "name":"IsEscalated"
                },
                {
                    "name":"First_Contact_Close__c"
                },
                {
                    "defaultValue":"N/A",
                    "name":"Type_of_Support__c"
                },
                {
                    "defaultValue":"N/A",
                    "name":"Status"
                },
                {
                    "name":"MilestoneStatus"
                },
                {
                    "defaultValue":"N/A",
                    "name":"Product_Family_KB__c"
                },
                {
                    "defaultValue":"N/A",
                    "name":"Priority"
                },
                {
                    "name":"CaseNumber"
                },
                {
                    "defaultValue":"N/A",
                    "name":"RecordTypeId"
                },
                {
                    "name":"Response_Time_mins__c"
                }
            ],
            "object":"Case"
        }
    },
    "Join_CaseAccountContactUser":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Join_CaseAccountContact",
            "left_key":[
                "OwnerId"
            ],
            "right_select":[
                "CallCenterId",
                "Name",
                "Id",
                "UserRoleId",
                "Type"
            ],
            "right":"Append_Queue_User",
            "relationship":"Owner"
        }
    },
    "Case_CSAT_Mea":{
        "action":"dim2mea",
        "parameters":{
            "measure":"CSAT",
            "measureDefault":"-999",
            "source":"compute_CalculatedCaseDuration",
            "dimension":"CSAT__c",
            "measureType":"long"
        }
    },
    "Join_CaseHistory_NewOwner":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Join_CaseHistory_OldOwner",
            "left_key":[
                "NewOwner"
            ],
            "right_select":[
                "CallCenterId",
                "Name",
                "Id",
                "Role.Name",
                "Type"
            ],
            "right":"Join_CaseHistory_Queue_User_UserRole",
            "relationship":"NewOwner"
        }
    },
    "Join_LiveChatTranscript_Case":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Join_LiveChatTranscript_User",
            "left_key":[
                "CaseId"
            ],
            "right_select":[
                "Origin",
                "Reason",
                "Type",
                "IsClosed",
                "ClosedDate",
                "CreatedDate",
                "Type_of_Support__c",
                "Status",
                "Product_Family_KB__c",
                "Priority",
                "CaseNumber",
                "Account.Name",
                "Account.Id",
                "Duration__c",
                "CSAT__c",
                "Role.Name",
                "CurrentDate",
                "CSAT",
                "RecordType.Name"
            ],
            "right":"Join_CaseAccountContactUserUserRoleRecordType",
            "relationship":"Case"
        }
    },
    "Join_ActivityOwner_Case":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Join_ActivityOwner",
            "left_key":[
                "WhatId"
            ],
            "right_select":[
                "Id",
                "Origin",
                "Reason",
                "Type",
                "IsClosed",
                "ClosedDate",
                "CreatedDate",
                "Type_of_Support__c",
                "Status",
                "Product_Family_KB__c",
                "Priority",
                "CaseNumber",
                "RecordType.Name",
                "Account.Name",
                "Account.Id",
                "Duration__c",
                "Role.Name",
                "CurrentDate",
                "Response_Time_mins__c"
            ],
            "right":"Handle_Null_RecordType",
            "relationship":"Case"
        }
    },
    "computeJoin_ServiceCaseTaskEvent":{
        "action":"computeExpression",
        "parameters":{
            "source":"Join_ServiceCaseTaskEvent",
            "computedFields":[
                {
                    "defaultValue":"0",
                    "precision":18,
                    "name":"sum_last_activity",
                    "saqlExpression":"case when ('Task.ActivityLastModifiedDate_sec_epoch' > 'Event.ActivityLastModifiedDate_sec_epoch' && 'Task.ActivityLastModifiedDate_sec_epoch' >= 'LastModifiedDate_sec_epoch') then  ('CurrentDate_sec_epoch' - 'Task.ActivityLastModifiedDate_sec_epoch')/86400 when ('Event.ActivityLastModifiedDate_sec_epoch' > 'Task.ActivityLastModifiedDate_sec_epoch' && 'Event.ActivityLastModifiedDate_sec_epoch' >= 'LastModifiedDate_sec_epoch') then ('CurrentDate_sec_epoch' - 'Event.ActivityLastModifiedDate_sec_epoch')/86400  when ('LastModifiedDate_sec_epoch' >= 'Task.ActivityLastModifiedDate_sec_epoch' && 'LastModifiedDate_sec_epoch' >= 'Event.ActivityLastModifiedDate_sec_epoch') then ('CurrentDate_sec_epoch' - 'LastModifiedDate_sec_epoch')/86400  else ('CurrentDate_sec_epoch' - 'LastModifiedDate_sec_epoch')/86400 end",
                    "scale":2,
                    "label":"Last LastModifiedDate",
                    "type":"Numeric"
                }
            ],
            "mergeWithSource":true
        }
    },
    "compute_CurrentDateForCase":{
        "action":"computeExpression",
        "parameters":{
            "source":"Extract_Case",
            "computedFields":[
                {
                    "format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'",
                    "name":"CurrentDate",
                    "saqlExpression":"now()",
                    "label":"CurrentDate",
                    "type":"Date"
                },
                {
                    "format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'",
                    "name":"ValidToWithNow",
                    "saqlExpression":"case  when ('IsClosed' == \"true\") then toDate('ClosedDate', \"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\") else now()  end",
                    "label":"ValidToWithNow",
                    "type":"Date"
                }
            ],
            "mergeWithSource":true
        }
    },
    "Extract_Knowledge_ka":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"Id"
                },
                {
                    "name":"ArticleNumber"
                },
                {
                    "name":"CaseAssociationCount"
                },
                {
                    "name":"CreatedById"
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"CreatedDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"FirstPublishedDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"LastPublishedDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "name":"LastModifiedById"
                }
            ],
            "object":"KCSArticle__ka"
        }
    },
    "Handle_Null_Opportunity_RecordType":{
        "action":"computeExpression",
        "parameters":{
            "source":"Join_OpportunityRecordType",
            "computedFields":[
                {
                    "name":"RecordTypeName",
                    "saqlExpression":"case when RecordTypeId is null then \"N/A\" else 'RecordType.Name' end",
                    "label":"Opportunity Record Type",
                    "type":"Text"
                }
            ],
            "mergeWithSource":true
        }
    },
    "Add_Fields_To_User":{
        "action":"computeExpression",
        "parameters":{
            "source":"Extract_User",
            "computedFields":[
                {
                    "name":"Type",
                    "saqlExpression":"\"User\"",
                    "label":"Type",
                    "type":"Text"
                }
            ],
            "mergeWithSource":true
        }
    },
    "Join_Append_Knowledge__ka_kav_dataCategory_ViewStat":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "ParentId"
            ],
            "left":"Join_Append_Knowledge__ka_kav_dataCategory",
            "left_key":[
                "Id"
            ],
            "right_select":[
                "Channel",
                "ViewCount",
                "NormalizedScore"
            ],
            "right":"Extract_Knowledge_ViewStat",
            "relationship":"ViewStat"
        }
    },
    "Register_ServiceCaseHistory":{
        "action":"sfdcRegister",
        "parameters":{
            "name":"ServiceCaseHistory",
            "alias":"ServiceCaseHistory2",
            "source":"Join_CaseHistory_NewOwner"
        }
    },
    "Join_AgentWorkUserGroupServiceChannelCase_NoCSAT":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Join_AgentWorkUserGroupServiceChannel",
            "left_key":[
                "WorkItemId"
            ],
            "right_select":[
                "Origin",
                "Reason",
                "Type",
                "IsClosed",
                "ClosedDate",
                "CreatedDate",
                "Type_of_Support__c",
                "Status",
                "Product_Family_KB__c",
                "Priority",
                "CaseNumber",
                "Account.Name",
                "Account.Id",
                "Duration__c",
                "Role.Name",
                "CurrentDate",
                "RecordType.Name"
            ],
            "right":"Join_CaseAccountContactUserUserRoleRecordType",
            "relationship":"Case"
        }
    },
    "Extract_Knowledge_kav_archived":{
        "action":"sfdcDigest",
        "parameters":{
            "enablePKChunking":false,
            "fields":[
                {
                    "name":"Id"
                },
                {
                    "name":"ArticleNumber"
                },
                {
                    "name":"CreatedById"
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"CreatedDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "name":"OwnerId"
                },
                {
                    "name":"PublishStatus"
                },
                {
                    "name":"IsLatestVersion"
                },
                {
                    "name":"IsVisibleInApp"
                },
                {
                    "name":"IsVisibleInCsp"
                },
                {
                    "name":"IsVisibleInPkb"
                },
                {
                    "name":"IsVisibleInPrm"
                },
                {
                    "name":"KnowledgeArticleId"
                },
                {
                    "name":"Title"
                },
                {
                    "name":"VersionNumber",
                    "type":"Text"
                }
            ],
            "complexFilterConditions":"language = 'en_US' and PublishStatus='Archived'",
            "object":"KCSArticle__kav"
        }
    },
    "Register_ActivityOwner_Case":{
        "action":"sfdcRegister",
        "parameters":{
            "SFDCtoken":"SFDCtoken",
            "name":"ServiceActivity",
            "alias":"ServiceActivity2",
            "source":"Filter_Activities"
        }
    },
    "Extract_Task":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"Id"
                },
                {
                    "name":"CallObject"
                },
                {
                    "name":"CallDurationInSeconds"
                },
                {
                    "defaultValue":"N/A",
                    "name":"CallDisposition"
                },
                {
                    "defaultValue":"N/A",
                    "name":"CallType"
                },
                {
                    "name":"OwnerId"
                },
                {
                    "defaultValue":"N/A",
                    "name":"Status"
                },
                {
                    "defaultValue":"N/A",
                    "name":"Priority"
                },
                {
                    "name":"IsClosed"
                },
                {
                    "defaultValue":"N/A",
                    "name":"TaskSubtype"
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"CreatedDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"ActivityDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"LastModifiedDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "defaultValue":"N/A",
                    "name":"Subject"
                },
                {
                    "name":"WhatId"
                }
            ],
            "object":"Task"
        }
    },
    "Register_LiveChatTranscriptEvent":{
        "action":"sfdcRegister",
        "parameters":{
            "name":"ServiceChatTranscriptEvent",
            "alias":"ServiceChatTranscriptEvent",
            "source":"compute_LiveChatTranscriptEventLCT"
        }
    },
    "Append_TaskEvent":{
        "action":"append",
        "parameters":{
            "sources":[
                "Add_Fields_To_Task",
                "Add_Fields_To_Event"
            ]
        }
    },
    "Extract_ServicePresenceStatus":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"MasterLabel"
                },
                {
                    "name":"Id"
                }
            ],
            "object":"ServicePresenceStatus"
        }
    },
    "Register_LiveChatTranscript":{
        "action":"sfdcRegister",
        "parameters":{
            "name":"ServiceChatTranscript",
            "alias":"ServiceChatTranscript",
            "source":"compute_LiveChatTranscriptCSAT"
        }
    },
    "Extract_CaseArticleKnowledge":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"ArticleVersionNumber",
                    "type":"Text"
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"CreatedDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "name":"CaseId"
                },
                {
                    "name":"CreatedById"
                },
                {
                    "name":"KnowledgeArticleId"
                },
                {
                    "name":"IsSharedByEmail"
                }
            ],
            "object":"CaseArticle"
        }
    },
    "Extract_Knowledge_VoteStat":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"Channel"
                },
                {
                    "name":"ParentId"
                },
                {
                    "name":"NormalizedScore"
                }
            ],
            "object":"KCSArticle__VoteStat"
        }
    },
    "Extract_LiveChatTranscriptEvent":{
        "action":"sfdcDigest",
        "parameters":{
            "filterConditions":[
                {
                    "field":"Type",
                    "value":[
                        "Accept",
                        "Transfer",
                        "OperatorJoinedConference"
                    ],
                    "operator":"IN"
                }
            ],
            "enablePKChunking":false,
            "fields":[
                {
                    "name":"Detail"
                },
                {
                    "name":"Time"
                },
                {
                    "name":"Type"
                },
                {
                    "name":"LiveChatTranscriptId"
                },
                {
                    "name":"AgentId"
                }
            ],
            "object":"LiveChatTranscriptEvent"
        }
    },
    "Add_Fields_To_Event":{
        "action":"computeExpression",
        "parameters":{
            "source":"Extract_Event",
            "computedFields":[
                {
                    "name":"CallObject",
                    "saqlExpression":"\"000000000000000\"",
                    "label":"CallObject",
                    "type":"Text"
                },
                {
                    "name":"Type",
                    "saqlExpression":"\"Event\"",
                    "label":"Type",
                    "type":"Text"
                },
                {
                    "name":"CallDisposition",
                    "saqlExpression":"\"Event\"",
                    "label":"CallDisposition",
                    "type":"Text"
                },
                {
                    "name":"CallType",
                    "saqlExpression":"\"Event\"",
                    "label":"CallType",
                    "type":"Text"
                },
                {
                    "name":"Status",
                    "saqlExpression":"\"Event\"",
                    "label":"Status",
                    "type":"Text"
                },
                {
                    "name":"Priority",
                    "saqlExpression":"\"Event\"",
                    "label":"Priority",
                    "type":"Text"
                },
                {
                    "name":"TaskSubtype",
                    "saqlExpression":"EventSubtype",
                    "label":"TaskSubtype",
                    "type":"Text"
                },
                {
                    "name":"ActivityType",
                    "saqlExpression":"EventSubtype",
                    "label":"ActivityType",
                    "type":"Text"
                },
                {
                    "defaultValue":"0",
                    "precision":8,
                    "name":"CallDurationInSeconds",
                    "saqlExpression":"0",
                    "scale":0,
                    "label":"CallDurationInSeconds",
                    "type":"Numeric"
                },
                {
                    "name":"IsClosed",
                    "saqlExpression":"case when date(ActivityDate_Year,ActivityDate_Month,ActivityDate_Day) in [\"1 year ago\"..\"current day\"] then \"false\" else \"true\" end",
                    "label":"IsClosed",
                    "type":"Text"
                }
            ],
            "mergeWithSource":true
        }
    },
    "Join_CaseHistory_Queue_User_UserRole":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Append_Queue_User",
            "left_key":[
                "UserRoleId"
            ],
            "right_select":[
                "Name"
            ],
            "right":"Extract_UserRole",
            "relationship":"Role"
        }
    },
    "Register_KnowledgeAttached":{
        "action":"sfdcRegister",
        "parameters":{
            "name":"ServiceKnowledgeAttached",
            "alias":"ServiceKnowledgeAttached1",
            "source":"computeKnowledgeCitationFlag"
        }
    },
    "Join_OpportunityRecordType":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Extract_Opportunity",
            "left_key":[
                "RecordTypeId"
            ],
            "right_select":[
                "Name"
            ],
            "right":"Extract_RecordTypes",
            "relationship":"RecordType"
        }
    },
    "compute_LiveChatTranscriptEventLCT":{
        "action":"computeExpression",
        "parameters":{
            "source":"Join_LiveChatTranscriptEventLCT",
            "computedFields":[
                {
                    "name":"IsChatTransfered",
                    "saqlExpression":"case when 'LCT.Status' == \"Completed\" && (('Type' == \"Accept\") || ('Type' ==  \"Transfer\")  || ('Type' ==  \"OperatorJoinedConference\")) && 'LCT.StartTime' != 'Time' then 1 else 0 end ",
                    "scale":0,
                    "label":"Is Chat Transfered",
                    "type":"Numeric"
                },
                {
                    "precision":18,
                    "name":"AgentChatEndTime_sec_epoch",
                    "saqlExpression":"case when 'TempAgentChatEndTime_sec_epoch' == 'Time_sec_epoch' then 'LCT.EndTime_sec_epoch' else 'TempAgentChatEndTime_sec_epoch' end ",
                    "scale":2,
                    "label":"Agent Chat End Time",
                    "type":"Numeric"
                },
                {
                    "precision":18,
                    "name":"AgentChatDuration",
                    "saqlExpression":"case when 'TempAgentChatEndTime_sec_epoch' == 'Time_sec_epoch' then 'LCT.EndTime_sec_epoch' - 'Time_sec_epoch' else 'TempAgentChatEndTime_sec_epoch' - 'Time_sec_epoch' end ",
                    "scale":2,
                    "label":"Agent Chat Duration",
                    "type":"Numeric"
                }
            ],
            "mergeWithSource":true
        }
    },
    "Extract_LiveChatButton":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"MasterLabel"
                },
                {
                    "name":"CustomAgentName"
                },
                {
                    "name":"Id"
                }
            ],
            "object":"LiveChatButton"
        }
    },
    "Append_Knowledge_kav":{
        "action":"append",
        "parameters":{
            "sources":[
                "Extract_Knowledge_kav_online",
                "Extract_Knowledge_kav_archived"
            ]
        }
    },
    "Extract_CaseHistory":{
        "action":"sfdcDigest",
        "parameters":{
            "enablePKChunking":false,
            "fields":[
                {
                    "name":"CaseId"
                },
                {
                    "name":"CreatedById"
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"CreatedDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "name":"Field"
                },
                {
                    "name":"Id"
                },
                {
                    "name":"NewValue"
                },
                {
                    "name":"OldValue"
                }
            ],
            "complexFilterConditions":"CreatedDate >= LAST_N_MONTHS:18 and Field IN ('Status', 'Owner')",
            "object":"CaseHistory"
        }
    },
    "Extract_RecordTypes":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"Name"
                },
                {
                    "name":"Id"
                }
            ],
            "object":"RecordType"
        }
    },
    "Extract_Account":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"Id"
                },
                {
                    "name":"Name"
                },
                {
                    "defaultValue":"N/A",
                    "name":"BillingState"
                },
                {
                    "defaultValue":"N/A",
                    "name":"Industry"
                }
            ],
            "object":"Account"
        }
    },
    "Join_AgentWorkUserGroup":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Join_AgentWorkUser",
            "left_key":[
                "OriginalQueueId"
            ],
            "right_select":[
                "Name"
            ],
            "right":"Extract_Group",
            "relationship":"Group"
        }
    },
    "Join_ServiceCaseTaskEvent":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "WhatId"
            ],
            "left":"Join_ServiceCaseServiceTask",
            "left_key":[
                "Id"
            ],
            "right_select":[
                "ActivityLastModifiedDate"
            ],
            "right":"Compute_Extract_Event",
            "relationship":"Event"
        }
    },
    "computeJoin_ServiceCaseTask":{
        "action":"computeExpression",
        "parameters":{
            "source":"Join_ServiceCaseServiceTask",
            "computedFields":[
                {
                    "defaultValue":"0",
                    "precision":18,
                    "name":"sum_last_activity",
                    "saqlExpression":"case when ('Task.ActivityLastModifiedDate_sec_epoch' >= 'LastModifiedDate_sec_epoch') then ('CurrentDate_sec_epoch' - 'Task.ActivityLastModifiedDate_sec_epoch')/86400 when ('LastModifiedDate_sec_epoch' >= 'Task.ActivityLastModifiedDate_sec_epoch') then ('CurrentDate_sec_epoch' - 'LastModifiedDate_sec_epoch')/86400  else ('CurrentDate_sec_epoch' - 'LastModifiedDate_sec_epoch')/86400 end",
                    "scale":2,
                    "label":"Last LastModifiedDate",
                    "type":"Numeric"
                }
            ],
            "mergeWithSource":true
        }
    },
    "Extract_UserRole":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"Id"
                },
                {
                    "name":"Name"
                },
                {
                    "name":"ParentRoleId"
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"LastModifiedDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "name":"LastModifiedById"
                },
                {
                    "name":"SystemModstamp"
                }
            ],
            "object":"UserRole"
        }
    },
    "Join_CaseAccountContactUserUserRole":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Join_CaseAccountContactUser",
            "left_key":[
                "Owner.UserRoleId"
            ],
            "right_select":[
                "Name",
                "ParentRoleId"
            ],
            "right":"Extract_UserRole",
            "relationship":"Role"
        }
    },
    "Compute_Extract_Event":{
        "action":"computeRelative",
        "parameters":{
            "partitionBy":[
                "WhatId"
            ],
            "orderBy":[
                {
                    "name":"LastModifiedDate",
                    "direction":"asc"
                }
            ],
            "source":"Extract_Event",
            "computedFields":[
                {
                    "expression":{
                        "sourceField":"LastModifiedDate",
                        "default":"current()",
                        "offset":"first()"
                    },
                    "name":"ActivityLastModifiedDate",
                    "description":"ActivityLastModifiedDate",
                    "label":"ActivityLastModifiedDate"
                }
            ]
        }
    },
    "compute_CaseHistory_OldNewStatus":{
        "action":"computeExpression",
        "parameters":{
            "source":"compute_CaseHistory_CurrentDate",
            "computedFields":[
                {
                    "name":"NewStatus",
                    "saqlExpression":"case when 'Field' == \"created\" then \"Created\" when 'Field' == \"Status\" then 'NewValue' else\"NA\" end ",
                    "label":"New Status",
                    "type":"Text"
                },
                {
                    "name":"OldStatus",
                    "saqlExpression":"case when 'Field' == \"closed\" then \"Closed\" when 'Field' == \"Status\" then 'OldValue' else \"NA\" end ",
                    "label":"Old Status",
                    "type":"Text"
                },
                {
                    "defaultValue":"N/A",
                    "name":"NewOwner",
                    "saqlExpression":"case when 'Field' == \"Owner\" then 'NewValue' else\"NA\" end ",
                    "label":"New Owner",
                    "type":"Text"
                },
                {
                    "defaultValue":"N/A",
                    "name":"OldOwner",
                    "saqlExpression":"case when 'Field' == \"Owner\" then 'OldValue' else \"NA\" end ",
                    "label":"Old Owner",
                    "type":"Text"
                },
                {
                    "defaultValue":"0",
                    "precision":18,
                    "name":"DateDiffOld",
                    "saqlExpression":"case when ('CreatedDatePrev' is null) then ('CreatedDate_sec_epoch' - 'Case.CreatedDate_sec_epoch')/86400  else ('CreatedDate_sec_epoch' - 'CreatedDatePrev_sec_epoch')/86400 end",
                    "scale":2,
                    "label":"Date Diff Old",
                    "type":"Numeric"
                },
                {
                    "defaultValue":"0",
                    "precision":18,
                    "name":"DateDiffNew",
                    "saqlExpression":"case  when ('Case.IsClosed' == \"true\" && 'CreatedDateNext' is null && CreatedDate <= 'Case.ClosedDate') then ('Case.ClosedDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400   when ('Case.IsClosed' == \"true\" &&  CreatedDate > 'Case.ClosedDate') then 0 when 'CreatedDateNext' is null then ('CurrentDate_sec_epoch' -'CreatedDate_sec_epoch')/86400 else ('CreatedDateNext_sec_epoch' - 'CreatedDate_sec_epoch')/86400 end",
                    "scale":2,
                    "label":"Date Diff New",
                    "type":"Numeric"
                },
                {
                    "defaultValue":"false",
                    "name":"ChangeAfterCloseDate",
                    "saqlExpression":"case  when ('Field' == \"Owner\" && 'CreatedDate' > 'Case.ClosedDate') then \"true\"  else \"false\" end ",
                    "label":"Change After CloseDate",
                    "type":"Text"
                },
                {
                    "defaultValue":"false",
                    "name":"IsLastChange",
                    "saqlExpression":"case when ('Case.ClosedDate' is null && 'ValidToDate' == \"3000-10-10T10:10:10.100Z\") then \"true\" when ('ValidFromDate' <= 'Case.ClosedDate' && 'ValidToDate' > 'Case.ClosedDate') then \"true\" else \"false\" end ",
                    "label":"Last Change",
                    "type":"Text"
                }
            ],
            "mergeWithSource":true
        }
    },
    "Extract_Group":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"Name"
                },
                {
                    "name":"Id"
                }
            ],
            "object":"Group"
        }
    },
    "Extract_Event":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"OwnerId"
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"CreatedDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"LastModifiedDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "fiscalMonthOffset":0,
                    "firstDayOfWeek":"0",
                    "name":"ActivityDate",
                    "isYearEndFiscalYear":false
                },
                {
                    "name":"EndDateTime"
                },
                {
                    "defaultValue":"N/A",
                    "name":"Subject"
                },
                {
                    "name":"ShowAs"
                },
                {
                    "name":"DurationInMinutes"
                },
                {
                    "defaultValue":"N/A",
                    "name":"EventSubtype"
                },
                {
                    "name":"WhatId"
                }
            ],
            "object":"Event"
        }
    },
    "Append_CaseHistory":{
        "action":"append",
        "parameters":{
            "sources":[
                "compute_CaseHistory_DatePrevious_Status",
                "compute_CaseHistory_DatePrevious_Owner"
            ]
        }
    },
    "Join_LiveChatTranscriptEventLCT":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"compute_LiveChatTranscriptEvent_ChatBoundaries",
            "left_key":[
                "LiveChatTranscriptId"
            ],
            "right_select":[
                "Status",
                "ChatDuration",
                "EndedBy",
                "StartTime",
                "EndTime",
                "RequestTime"
            ],
            "right":"compute_LiveChatTranscriptCSAT",
            "relationship":"LCT"
        }
    },
    "Join_CaseHistory_Case":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Append_CaseHistory",
            "left_key":[
                "CaseId"
            ],
            "right_select":[
                "IsClosed",
                "ClosedDate",
                "CreatedDate",
                "Duration__c",
                "Product_Family_KB__c",
                "Origin",
                "Reason",
                "Type_of_Support__c",
                "Priority",
                "IsEscalated",
                "MilestoneStatus",
                "RecordType.Name",
                "Account.Name",
                "Account.Id",
                "Type",
                "CaseNumber"
            ],
            "right":"Join_CaseAccountContactUserUserRoleRecordType",
            "relationship":"Case"
        }
    },
    "Join_CaseAccount":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Case_CSAT_Mea",
            "left_key":[
                "AccountId"
            ],
            "right_select":[
                "Id",
                "Name",
                "BillingState",
                "Industry"
            ],
            "right":"Extract_Account",
            "relationship":"Account"
        }
    },
    "Join_CaseAccountContact":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"computeJoin_ServiceCaseTaskEvent",
            "left_key":[
                "ContactId"
            ],
            "right_select":[
                "Name",
                "Id"
            ],
            "right":"Extract_Contact",
            "relationship":"Contact"
        }
    },
    "compute_AgentWorkCSAT":{
        "action":"computeExpression",
        "parameters":{
            "source":"Join_AgentWorkUserGroupServiceChannelCase",
            "mergeWithSource":true,
            "computedFields":[
                {
                    "name":"CSAT",
                    "saqlExpression":"case when 'Case.CreatedDate' is null then -999 else 'Case.CSAT' end ",
                    "scale":0,
                    "type":"Numeric"
                }
            ]
        }
    },
    "Compute_Extract_Task":{
        "action":"computeRelative",
        "parameters":{
            "partitionBy":[
                "WhatId"
            ],
            "orderBy":[
                {
                    "name":"LastModifiedDate",
                    "direction":"asc"
                }
            ],
            "source":"Extract_Task",
            "computedFields":[
                {
                    "expression":{
                        "sourceField":"LastModifiedDate",
                        "default":"current()",
                        "offset":"first()"
                    },
                    "name":"ActivityLastModifiedDate",
                    "description":"ActivityLastModifiedDate",
                    "label":"ActivityLastModifiedDate"
                }
            ]
        }
    },
    "Extract_User":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"CallCenterId"
                },
                {
                    "name":"Name"
                },
                {
                    "name":"UserRoleId"
                },
                {
                    "name":"Id"
                }
            ],
            "object":"User"
        }
    },
    "Extract_UserServicePresence":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"AtCapacityDuration"
                },
                {
                    "name":"AverageCapacity"
                },
                {
                    "name":"ConfiguredCapacity"
                },
                {
                    "name":"CreatedDate"
                },
                {
                    "name":"IsDeleted"
                },
                {
                    "name":"IdleDuration"
                },
                {
                    "name":"IsAway"
                },
                {
                    "name":"IsCurrentState"
                },
                {
                    "name":"LastModifiedDate"
                },
                {
                    "name":"Name"
                },
                {
                    "name":"StatusDuration"
                },
                {
                    "name":"StatusEndDate"
                },
                {
                    "name":"StatusStartDate"
                },
                {
                    "name":"SystemModstamp"
                },
                {
                    "name":"Id"
                },
                {
                    "name":"UserId"
                },
                {
                    "name":"ServicePresenceStatusId"
                }
            ],
            "object":"UserServicePresence"
        }
    },
    "Register_Knowledge":{
        "action":"sfdcRegister",
        "parameters":{
            "name":"ServiceKnowledge",
            "alias":"ServiceKnowledge1",
            "source":"computeKnowledgeDraftStatusAndChannelField"
        }
    },
    "Join_OpportunityRecordTypeAccount":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Handle_Null_Opportunity_RecordType",
            "left_key":[
                "AccountId"
            ],
            "right_select":[
                "Id",
                "Name",
                "BillingState",
                "Industry"
            ],
            "right":"Extract_Account",
            "relationship":"Account"
        }
    },
    "computeKnowledgeCitationFlag":{
        "action":"computeExpression",
        "parameters":{
            "source":"Join_CaseArticleKnowledge_User_Case_Knowledge",
            "computedFields":[
                {
                    "name":"isAttachedByOwner",
                    "saqlExpression":"case when 'CreatedById' == 'Article.CreatedById' then \"true\" else \"false\" end",
                    "label":"is Attached By Owner?",
                    "type":"Text"
                }
            ],
            "mergeWithSource":true
        }
    },
    "compute_CaseHistory_DatePrevious_Owner":{
        "action":"computeRelative",
        "parameters":{
            "partitionBy":[
                "CaseId"
            ],
            "orderBy":[
                {
                    "name":"CreatedDate",
                    "direction":"asc"
                }
            ],
            "source":"Filter_CaseHistoryOwner",
            "computedFields":[
                {
                    "expression":{
                        "sourceField":"CreatedDate",
                        "default":"3000-10-10T10:10:10.100Z",
                        "offset":"next()"
                    },
                    "name":"ValidToDate",
                    "description":"ValidToDate",
                    "label":"ValidToDate"
                },
                {
                    "expression":{
                        "sourceField":"CreatedDate",
                        "default":"current()",
                        "offset":"current()"
                    },
                    "name":"ValidFromDate",
                    "description":"ValidFromDate",
                    "label":"ValidFromDate"
                },
                {
                    "expression":{
                        "sourceField":"CreatedDate",
                        "default":null,
                        "offset":"next()"
                    },
                    "name":"CreatedDateNext",
                    "description":"Next Created Date",
                    "label":"Next CreatedDate"
                },
                {
                    "expression":{
                        "sourceField":"CreatedDate",
                        "default":null,
                        "offset":"previous()"
                    },
                    "name":"CreatedDatePrev",
                    "description":"Previous Created Date",
                    "label":"Previous CreatedDate"
                }
            ]
        }
    },
    "Filter_CaseHistoryStatus":{
        "action":"filter",
        "parameters":{
            "filter":"Field:EQ:Status",
            "source":"Extract_CaseHistory"
        }
    },
    "Handle_Null_Attached_Articles":{
        "action":"dim2mea",
        "parameters":{
            "measure":"ArticleVersion",
            "measureDefault":"0",
            "source":"Join_CaseAccountContactUserUserRoleCaseArticle",
            "dimension":"CaseArticle.ArticleVersionNumber",
            "measureType":"long"
        }
    },
    "Extract_Queue":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"Id"
                },
                {
                    "name":"Name"
                }
            ],
            "complexFilterConditions":"Type = 'Queue'",
            "object":"Group"
        }
    },
    "Extract_AgentWork":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"AcceptDateTime"
                },
                {
                    "name":"ActiveTime"
                },
                {
                    "name":"AgentCapacityWhenDeclined"
                },
                {
                    "name":"Id"
                },
                {
                    "name":"AssignedDateTime"
                },
                {
                    "name":"CancelDateTime"
                },
                {
                    "name":"CloseDateTime"
                },
                {
                    "name":"CreatedDate"
                },
                {
                    "name":"DeclineDateTime"
                },
                {
                    "name":"DeclineReason"
                },
                {
                    "name":"IsDeleted"
                },
                {
                    "name":"HandleTime"
                },
                {
                    "name":"LastModifiedDate"
                },
                {
                    "name":"Name"
                },
                {
                    "name":"CapacityPercentage"
                },
                {
                    "name":"PushTimeout"
                },
                {
                    "name":"PushTimeoutDateTime"
                },
                {
                    "name":"RequestDateTime"
                },
                {
                    "name":"SpeedToAnswer"
                },
                {
                    "name":"Status"
                },
                {
                    "name":"SystemModstamp"
                },
                {
                    "name":"CapacityWeight"
                },
                {
                    "name":"UserId"
                },
                {
                    "name":"OriginalQueueId"
                },
                {
                    "name":"ServiceChannelId"
                },
                {
                    "name":"WorkItemId"
                }
            ],
            "object":"AgentWork"
        }
    },
    "Extract_Knowledge_ViewStat":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"Channel"
                },
                {
                    "name":"ParentId"
                },
                {
                    "name":"ViewCount"
                },
                {
                    "name":"NormalizedScore"
                }
            ],
            "object":"KCSArticle__ViewStat"
        }
    },
    "Handle_Null_RecordType":{
        "action":"computeExpression",
        "parameters":{
            "source":"Join_CaseAccountContactUserUserRoleRecordType",
            "computedFields":[
                {
                    "name":"RecordTypeName",
                    "saqlExpression":"case when RecordTypeId is null then \"N/A\" else 'RecordType.Name' end",
                    "label":"Case Record Type",
                    "type":"Text"
                }
            ],
            "mergeWithSource":true
        }
    },
    "Join_LiveChatTranscriptEvent_User":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Extract_LiveChatTranscriptEvent",
            "left_key":[
                "AgentId"
            ],
            "right_select":[
                "Name"
            ],
            "right":"Extract_User",
            "relationship":"User"
        }
    },
    "Filter_CaseHistoryOwner":{
        "action":"filter",
        "parameters":{
            "filter":"Field:EQ:Owner",
            "source":"Extract_CaseHistory"
        }
    },
    "Join_Append_Knowledge__kav_dataCategory":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "ParentId"
            ],
            "left":"Append_Knowledge_kav",
            "left_key":[
                "Id"
            ],
            "right_select":[
                "DataCategoryName",
                "DataCategoryGroupName"
            ],
            "right":"Extract_Knowledge_DataCategory",
            "relationship":"DataCategory",
            "operation":"LookupMultiValue"
        }
    },
    "Join_ServicePresenceUserStatus":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Join_ServicePresenceUser",
            "left_key":[
                "ServicePresenceStatusId"
            ],
            "right_select":[
                "MasterLabel"
            ],
            "right":"Extract_ServicePresenceStatus",
            "relationship":"ServicePresenceStatusId"
        }
    },
    "Join_OpportunityRecordTypeAccountCase":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "AccountId"
            ],
            "left":"Join_OpportunityRecordTypeAccount",
            "left_key":[
                "AccountId"
            ],
            "right_select":[
                "Id",
                "CaseNumber",
                "IsEscalated",
                "Priority"
            ],
            "right":"compute_CalculatedCaseDuration",
            "relationship":"Case"
        }
    },
    "Join_LiveChatTranscript_User":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"compute_LiveChatTranscript",
            "left_key":[
                "OwnerId"
            ],
            "right_select":[
                "Name"
            ],
            "right":"Extract_User",
            "relationship":"User"
        }
    },
    "Register_AgentWork":{
        "action":"sfdcRegister",
        "parameters":{
            "name":"ServiceOmniAgentWork",
            "alias":"ServiceOmniAgentWork",
            "source":"compute_AgentWorkCSAT"
        }
    },
    "Join_ActivityOwner":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Append_TaskEvent",
            "left_key":[
                "OwnerId"
            ],
            "right_select":[
                "Name",
                "Id",
                "UserRoleId"
            ],
            "right":"Extract_User",
            "relationship":"Owner"
        }
    },
    "Add_Fields_To_Queue":{
        "action":"computeExpression",
        "parameters":{
            "source":"Extract_Queue",
            "computedFields":[
                {
                    "name":"CallCenterId",
                    "saqlExpression":"\"000000000000000\"",
                    "label":"CallCenterId",
                    "type":"Text"
                },
                {
                    "name":"Type",
                    "saqlExpression":"\"Queue\"",
                    "label":"Type",
                    "type":"Text"
                },
                {
                    "name":"UserRoleId",
                    "saqlExpression":"\"000000000000000\"",
                    "label":"UserRoleId",
                    "type":"Text"
                }
            ],
            "mergeWithSource":true
        }
    },
    "compute_LiveChatTranscriptCSAT":{
        "action":"computeExpression",
        "parameters":{
            "source":"Join_LiveChatTranscript_Case",
            "mergeWithSource":true,
            "computedFields":[
                {
                    "name":"CSAT",
                    "saqlExpression":"case when 'CaseId' is null then -999 else 'Case.CSAT' end ",
                    "scale":0,
                    "type":"Numeric"
                }
            ]
        }
    },
    "Register_Opportunity":{
        "action":"sfdcRegister",
        "parameters":{
            "SFDCtoken":"SFDCtoken",
            "name":"ServiceOpportunities",
            "alias":"ServiceOpportunity2",
            "source":"Join_OpportunityRecordTypeAccountCase"
        }
    },
    "Join_Append_Knowledge__ka_kav_dataCategory_ViewStat_VoteStat_User":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Join_Append_Knowledge__ka_kav_dataCategory_ViewStat_VoteStat",
            "left_key":[
                "CreatedById"
            ],
            "right_select":[
                "Name"
            ],
            "right":"Extract_User",
            "relationship":"User"
        }
    },
    "Join_CaseArticleKnowledge_User_Case":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Join_CaseArticleKnowledge_User",
            "left_key":[
                "CaseId"
            ],
            "right_select":[
                "Product_Family_KB__c",
                "Reason",
                "Status",
                "Type_of_Support__c",
                "Type"
            ],
            "right":"compute_CalculatedCaseDuration",
            "relationship":"Case"
        }
    },
    "Join_CaseArticleKnowledge_User_Case_Knowledge":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Join_CaseArticleKnowledge_User_Case",
            "left_key":[
                "KnowledgeArticleId"
            ],
            "right_select":[
                "ArticleVersion.Title",
                "ArticleVersion.PublishStatus",
                "ArticleVersion.VersionNumber",
                "ArticleVersion.IsVisibleInApp",
                "ArticleVersion.IsVisibleInCsp",
                "ArticleVersion.IsVisibleInPkb",
                "ArticleVersion.IsVisibleInPrm",
                "ArticleVersion.DataCategory.DataCategoryName",
                "ArticleVersion.DataCategory.DataCategoryGroupName",
                "User.Name",
                "CreatedById"
            ],
            "right":"computeKnowledgeDraftStatusAndChannelField",
            "relationship":"Article"
        }
    },
    "computeKnowledgeDraftStatusAndChannelField":{
        "action":"computeExpression",
        "parameters":{
            "source":"Join_Append_Knowledge__ka_kav_dataCategory_ViewStat_VoteStat_User",
            "computedFields":[
                {
                    "name":"IsDraft",
                    "saqlExpression":"case when 'ArticleVersion.Id' is null then \"true\" else \"false\" end",
                    "label":"Is Draft",
                    "type":"Text"
                },
                {
                    "name":"ChannelList",
                    "saqlExpression":"case when ('ArticleVersion.IsVisibleInApp' == \"false\" && 'ArticleVersion.IsVisibleInPrm' == \"false\" && 'ArticleVersion.IsVisibleInCsp' == \"false\" && 'ArticleVersion.IsVisibleInPkb' == \"true\" ) then \"Public\" when ('ArticleVersion.IsVisibleInApp' == \"false\" && 'ArticleVersion.IsVisibleInPrm' == \"false\" && 'ArticleVersion.IsVisibleInCsp' == \"true\" && 'ArticleVersion.IsVisibleInPkb' == \"false\" ) then \"Customer\" when ('ArticleVersion.IsVisibleInApp' == \"false\" && 'ArticleVersion.IsVisibleInPrm' == \"false\" && 'ArticleVersion.IsVisibleInCsp' == \"true\" && 'ArticleVersion.IsVisibleInPkb' == \"true\" ) then \"Customer;Public\" when ('ArticleVersion.IsVisibleInApp' == \"false\" && 'ArticleVersion.IsVisibleInPrm' == \"true\" && 'ArticleVersion.IsVisibleInCsp' == \"false\" && 'ArticleVersion.IsVisibleInPkb' == \"false\" ) then \"Parter\" when ('ArticleVersion.IsVisibleInApp' == \"false\" && 'ArticleVersion.IsVisibleInPrm' == \"true\" && 'ArticleVersion.IsVisibleInCsp' == \"false\" && 'ArticleVersion.IsVisibleInPkb' == \"true\" ) then \"Parter;Public\" when ('ArticleVersion.IsVisibleInApp' == \"false\" && 'ArticleVersion.IsVisibleInPrm' == \"true\" && 'ArticleVersion.IsVisibleInCsp' == \"true\" && 'ArticleVersion.IsVisibleInPkb' == \"false\" ) then \"Parter;Customer\"    when ('ArticleVersion.IsVisibleInApp' == \"false\" && 'ArticleVersion.IsVisibleInPrm' == \"true\" && 'ArticleVersion.IsVisibleInCsp' == \"true\" && 'ArticleVersion.IsVisibleInPkb' == \"true\" ) then \"Parter;Customer;Public\" when ('ArticleVersion.IsVisibleInApp' == \"true\" && 'ArticleVersion.IsVisibleInPrm' == \"false\" && 'ArticleVersion.IsVisibleInCsp' == \"false\" && 'ArticleVersion.IsVisibleInPkb' == \"false\" ) then \"Internal\" when ('ArticleVersion.IsVisibleInApp' == \"true\" && 'ArticleVersion.IsVisibleInPrm' == \"false\" && 'ArticleVersion.IsVisibleInCsp' == \"false\" && 'ArticleVersion.IsVisibleInPkb' == \"true\" ) then \"Internal;Public\" when ('ArticleVersion.IsVisibleInApp' == \"true\" && 'ArticleVersion.IsVisibleInPrm' == \"false\" && 'ArticleVersion.IsVisibleInCsp' == \"true\" && 'ArticleVersion.IsVisibleInPkb' == \"false\" ) then \"Internal;Customer\" when ('ArticleVersion.IsVisibleInApp' == \"true\" && 'ArticleVersion.IsVisibleInPrm' == \"false\" && 'ArticleVersion.IsVisibleInCsp' == \"true\" && 'ArticleVersion.IsVisibleInPkb' == \"true\" ) then \"Internal;Customer;Public\" when ('ArticleVersion.IsVisibleInApp' == \"true\" && 'ArticleVersion.IsVisibleInPrm' == \"true\" && 'ArticleVersion.IsVisibleInCsp' == \"false\" && 'ArticleVersion.IsVisibleInPkb' == \"false\" ) then \"Internal;Parter\" when ('ArticleVersion.IsVisibleInApp' == \"true\" && 'ArticleVersion.IsVisibleInPrm' == \"true\" && 'ArticleVersion.IsVisibleInCsp' == \"false\" && 'ArticleVersion.IsVisibleInPkb' == \"true\" ) then \"Internal;Parter;Public\" when ('ArticleVersion.IsVisibleInApp' == \"true\" && 'ArticleVersion.IsVisibleInPrm' == \"true\" && 'ArticleVersion.IsVisibleInCsp' == \"true\" && 'ArticleVersion.IsVisibleInPkb' == \"false\" ) then \"Internal;Parter;Customer\" when ('ArticleVersion.IsVisibleInApp' == \"true\" && 'ArticleVersion.IsVisibleInPrm' == \"true\" && 'ArticleVersion.IsVisibleInCsp' == \"true\" && 'ArticleVersion.IsVisibleInPkb' == \"true\" ) then \"Internal;Parter;Customer;Public\" end",
                    "label":"Channel List",
                    "type":"Text"
                }
            ],
            "mergeWithSource":true
        }
    },
    "Join_Append_Knowledge__ka_kav_dataCategory_ViewStat_VoteStat":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "ParentId"
            ],
            "left":"Join_Append_Knowledge__ka_kav_dataCategory_ViewStat",
            "left_key":[
                "Id"
            ],
            "right_select":[
                "Channel",
                "NormalizedScore"
            ],
            "right":"Extract_Knowledge_VoteStat",
            "relationship":"VoteStat"
        }
    },
    "Join_CaseArticleKnowledge_User":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Extract_CaseArticleKnowledge",
            "left_key":[
                "CreatedById"
            ],
            "right_select":[
                "Id",
                "Name"
            ],
            "right":"Extract_User",
            "relationship":"User"
        }
    },
    "Append_Queue_User":{
        "action":"append",
        "parameters":{
            "sources":[
                "Add_Fields_To_Queue",
                "Add_Fields_To_User"
            ]
        }
    },
    "compute_LiveChatTranscriptEvent_ChatBoundaries":{
        "action":"computeRelative",
        "parameters":{
            "partitionBy":[
                "LiveChatTranscriptId"
            ],
            "orderBy":[
                {
                    "name":"Time",
                    "direction":"asc"
                }
            ],
            "source":"Join_LiveChatTranscriptEvent_User",
            "computedFields":[
                {
                    "expression":{
                        "sourceField":"Time",
                        "default":"current()",
                        "offset":"next()"
                    },
                    "name":"TempAgentChatEndTime",
                    "description":"Temp Agent Chat End Time",
                    "label":"TempAgentChatEndTime"
                }
            ]
        }
    },
    "Join_AgentWorkUserGroupServiceChannelCase":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Join_AgentWorkUserGroupServiceChannel",
            "left_key":[
                "WorkItemId"
            ],
            "right_select":[
                "Origin",
                "Reason",
                "Type",
                "IsClosed",
                "ClosedDate",
                "CreatedDate",
                "Type_of_Support__c",
                "Status",
                "Product_Family_KB__c",
                "Priority",
                "CaseNumber",
                "Account.Name",
                "Account.Id",
                "Duration__c",
                "CSAT__c",
                "Role.Name",
                "CurrentDate",
                "CSAT",
                "RecordType.Name"
            ],
            "right":"Join_CaseAccountContactUserUserRoleRecordType",
            "relationship":"Case"
        }
    },
    "Extract_Knowledge_DataCategory":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"DataCategoryGroupName"
                },
                {
                    "name":"DataCategoryName"
                },
                {
                    "name":"ParentId"
                }
            ],
            "object":"KCSArticle__DataCategorySelection"
        }
    },
    "Join_Append_Knowledge__ka_kav_dataCategory":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "KnowledgeArticleId"
            ],
            "left":"Extract_Knowledge_ka",
            "left_key":[
                "Id"
            ],
            "right_select":[
                "CreatedById",
                "CreatedDate",
                "OwnerId",
                "PublishStatus",
                "IsLatestVersion",
                "IsVisibleInApp",
                "IsVisibleInCsp",
                "IsVisibleInPkb",
                "IsVisibleInPrm",
                "Title",
                "VersionNumber",
                "Id",
                "DataCategory.DataCategoryName",
                "DataCategory.DataCategoryGroupName"
            ],
            "right":"Join_Append_Knowledge__kav_dataCategory",
            "relationship":"ArticleVersion"
        }
    },
    "compute_CaseHistory_CurrentDate":{
        "action":"computeExpression",
        "parameters":{
            "source":"Join_CaseHistory_Case",
            "computedFields":[
                {
                    "format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'",
                    "name":"CurrentDate",
                    "saqlExpression":"now()",
                    "label":"CurrentDate",
                    "type":"Date"
                },
                {
                    "name":"ValidToWithNow",
                    "saqlExpression":"case when 'ValidToDate' == \"3000-10-10T10:10:10.100Z\" then now() else toDate('ValidToDate', \"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'\") end",
                    "format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'",
                    "type":"Date"
                }
            ],
            "mergeWithSource":true
        }
    },
    "Join_AgentWorkUserGroupServiceChannel":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Join_AgentWorkUserGroup",
            "left_key":[
                "ServiceChannelId"
            ],
            "right_select":[
                "DeveloperName",
                "MasterLabel"
            ],
            "right":"Extract_ServiceChannel",
            "relationship":"ServiceChannelId"
        }
    },
    "Register_UserServicePresence":{
        "action":"sfdcRegister",
        "parameters":{
            "name":"ServiceOmniUserPresence",
            "alias":"ServiceOmniUserPresence",
            "source":"Join_ServicePresenceUserStatus"
        }
    },
    "compute_CalculatedCaseDuration":{
        "action":"computeExpression",
        "parameters":{
            "source":"compute_CurrentDateForCase",
            "computedFields":[
                {
                    "defaultValue":"0",
                    "precision":18,
                    "name":"DurationCalculatedField",
                    "saqlExpression":"case  when ('IsClosed' == \"true\") then ('ClosedDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400   else ('CurrentDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400  end",
                    "scale":2,
                    "label":"Case Duration",
                    "type":"Numeric"
                }
            ],
            "mergeWithSource":true
        }
    },
    "compute_CaseHistory_DatePrevious_Status":{
        "action":"computeRelative",
        "parameters":{
            "partitionBy":[
                "CaseId"
            ],
            "orderBy":[
                {
                    "name":"CreatedDate",
                    "direction":"asc"
                }
            ],
            "source":"Filter_CaseHistoryStatus",
            "computedFields":[
                {
                    "expression":{
                        "sourceField":"CreatedDate",
                        "default":"3000-10-10T10:10:10.100Z",
                        "offset":"next()"
                    },
                    "name":"ValidToDate",
                    "description":"ValidToDate",
                    "label":"ValidToDate"
                },
                {
                    "expression":{
                        "sourceField":"CreatedDate",
                        "default":"current()",
                        "offset":"current()"
                    },
                    "name":"ValidFromDate",
                    "description":"ValidFromDate",
                    "label":"ValidFromDate"
                },
                {
                    "expression":{
                        "sourceField":"CreatedDate",
                        "default":null,
                        "offset":"next()"
                    },
                    "name":"CreatedDateNext",
                    "description":"Next Created Date",
                    "label":"Next CreatedDate"
                },
                {
                    "expression":{
                        "sourceField":"CreatedDate",
                        "default":null,
                        "offset":"previous()"
                    },
                    "name":"CreatedDatePrev",
                    "description":"Previous Created Date",
                    "label":"Previous CreatedDate"
                }
            ]
        }
    },
    "Extract_LiveChatTranscript":{
        "action":"sfdcDigest",
        "parameters":{
            "fields":[
                {
                    "name":"Abandoned"
                },
                {
                    "name":"AverageResponseTimeOperator"
                },
                {
                    "name":"MaxResponseTimeOperator"
                },
                {
                    "name":"OperatorMessageCount"
                },
                {
                    "name":"Body"
                },
                {
                    "name":"Browser"
                },
                {
                    "name":"BrowserLanguage"
                },
                {
                    "name":"CaseId"
                },
                {
                    "name":"ChatDuration"
                },
                {
                    "name":"ChatKey"
                },
                {
                    "name":"CreatedDate"
                },
                {
                    "name":"IsDeleted"
                },
                {
                    "name":"EndTime"
                },
                {
                    "name":"EndedBy"
                },
                {
                    "name":"LastModifiedDate"
                },
                {
                    "name":"LastReferencedDate"
                },
                {
                    "name":"LastViewedDate"
                },
                {
                    "name":"LiveChatButtonId"
                },
                {
                    "name":"Id"
                },
                {
                    "name":"Name"
                },
                {
                    "name":"Location"
                },
                {
                    "name":"OwnerId"
                },
                {
                    "name":"Platform"
                },
                {
                    "name":"ReferrerUri"
                },
                {
                    "name":"RequestTime"
                },
                {
                    "name":"ScreenResolution"
                },
                {
                    "name":"StartTime"
                },
                {
                    "name":"Status"
                },
                {
                    "name":"SupervisorTranscriptBody"
                },
                {
                    "name":"SystemModstamp"
                },
                {
                    "name":"UserAgent"
                },
                {
                    "name":"AverageResponseTimeVisitor"
                },
                {
                    "name":"IpAddress"
                },
                {
                    "name":"MaxResponseTimeVisitor"
                },
                {
                    "name":"VisitorMessageCount"
                },
                {
                    "name":"WaitTime"
                }
            ],
            "object":"LiveChatTranscript"
        }
    },
    "compute_LiveChatTranscript":{
        "action":"computeExpression",
        "parameters":{
            "source":"Join_LCTButton",
            "computedFields":[
                {
                    "format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'",
                    "name":"StartTime_15Min",
                    "saqlExpression":"toDate(floor(StartTime_sec_epoch/900)*900)",
                    "label":"StartTime_15Min",
                    "type":"Date"
                }
            ],
            "mergeWithSource":true
        }
    },
    "Add_Fields_To_Task":{
        "action":"computeExpression",
        "parameters":{
            "source":"Extract_Task",
            "computedFields":[
                {
                    "format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'",
                    "name":"EndDateTime",
                    "saqlExpression":"now()",
                    "label":"EndDateTime",
                    "type":"Date"
                },
                {
                    "name":"Type",
                    "saqlExpression":"\"Task\"",
                    "label":"Type",
                    "type":"Text"
                },
                {
                    "name":"EventSubtype",
                    "saqlExpression":"TaskSubtype",
                    "label":"EventSubtype",
                    "type":"Text"
                },
                {
                    "name":"ActivityType",
                    "saqlExpression":"TaskSubtype",
                    "label":"ActivityType",
                    "type":"Text"
                },
                {
                    "name":"ShowAs",
                    "saqlExpression":"\"Task\"",
                    "label":"ShowAs",
                    "type":"Text"
                },
                {
                    "defaultValue":"0",
                    "precision":8,
                    "name":"DurationInMinutes",
                    "saqlExpression":"0",
                    "scale":0,
                    "label":"DurationInMinutes",
                    "type":"Numeric"
                }
            ],
            "mergeWithSource":true
        }
    },
    "Join_AgentWorkUser":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Extract_AgentWork",
            "left_key":[
                "UserId"
            ],
            "right_select":[
                "Name"
            ],
            "right":"Extract_User",
            "relationship":"UserId"
        }
    },
    "Join_LCTButton":{
        "action":"augment",
        "parameters":{
            "right_key":[
                "Id"
            ],
            "left":"Extract_LiveChatTranscript",
            "left_key":[
                "LiveChatButtonId"
            ],
            "right_select":[
                "MasterLabel",
                "CustomAgentName"
            ],
            "right":"Extract_LiveChatButton",
            "relationship":"LiveChatButton"
        }
    },
    "Filter_Activities":{
        "action":"filter",
        "parameters":{
            "filter":"IsActivity:EQ:Yes",
            "source":"Handle_Only_Activities"
        }
    },
    "Register_Case":{
        "action":"sfdcRegister",
        "parameters":{
            "SFDCtoken":"SFDCtoken",
            "name":"ServiceCase",
            "alias":"ServiceCase2",
            "source":"Handle_Null_RecordType"
        }
    }
}