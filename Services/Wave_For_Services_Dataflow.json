{"Join_CaseHistory_Case": {"action": "augment","parameters": {"right": "Join_CaseAccountContactUserUserRoleRecordType","right_select": ["IsClosed","ClosedDate","CreatedDate","Duration__c","Product_Name__c","Origin","Reason","Type_of_Support__c","Priority","IsEscalated","MilestoneStatus","RecordType.Name","Account.Name","Type"],"right_key": ["Id"],"left": "Relabel_CustomCaseHistory","left_key": ["CaseId"],"relationship": "Case"}},"Join_CaseHistory_OldOwner": {"action": "augment","parameters": {"right": "Join_CaseHistory_Queue_User_UserRole","right_select": ["CallCenterId","Name","Id","Role.Name","Type"],"right_key": ["Id"],"left": "compute_CaseHistory_OldNewStatus","left_key": ["OldOwner"],"relationship": "OldOwner"}},"Register_TaskOwner_Case": {"action": "sfdcRegister","parameters": {"alias": "ServiceTask","name": "ServiceTask","SFDCtoken": "SFDCtoken","source": "Filter_Task_Calls"}},"Join_CaseAccount": {"action": "augment","parameters": {"right": "Extract_Account","right_select": ["Id","Name","BillingState","Industry"],"right_key": ["Id"],"left": "Case_CSAT_Mea","left_key": ["AccountId"],"relationship": "Account"}},"Join_ServiceCaseServiceTask": {"action": "augment","parameters": {"right": "Compute_Extract_Task","right_select": ["TaskLastModifiedDate"],"right_key": ["WhatId"],"left": "Join_CaseAccount","left_key": ["Id"],"relationship": "Task"}},"Extract_Contact": {"action": "sfdcDigest","parameters": {"object": "contact","fields": [{"name": "Name"},{"name": "Id"}]}},"Extract_Opportunity": {"action": "sfdcDigest","parameters": {"object": "opportunity","SFDCtoken": "SFDCtoken","fields": [{"name": "Id"},{"name": "AccountId"},{"name": "OwnerId"},{"name": "Name"},{"defaultValue": "N/A","name": "StageName"},{"defaultValue": "N/A","name": "LeadSource"},{"name": "IsWon"},{"name": "IsClosed"},{"defaultValue": "N/A","name": "ForecastCategory"},{"defaultValue": "N/A","name": "ForecastCategoryName"},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "CreatedDate","isYearEndFiscalYear": false},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "CloseDate","isYearEndFiscalYear": false},{"name": "Amount"},{"name": "CreatedById"},{"name": "RecordTypeId"}]}},"Join_CaseAccountContact": {"action": "augment","parameters": {"right": "Extract_Contact","right_select": ["Name","Id"],"right_key": ["Id"],"left": "computeJoin_ServiceCaseTaskEvent","left_key": ["ContactId"],"relationship": "Contact"}},"Handle_Only_Task_Activities": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "IsActivity","saqlExpression": "case when 'Case.Id' is null then \"No\" else \"Yes\" end","label": "Is Activity","type": "Text"},{"name": "IsCall","saqlExpression": "case when CallDurationInSeconds > 0 then \"Yes\" else \"No\" end","label": "Is Call","type": "Text"}],"source": "Join_TaskOwner_Case"}},"Extract_Knowledge_kav_online": {"action": "sfdcDigest","parameters": {"object": "faq__kav","complexFilterConditions": "language = 'en_US' and PublishStatus='Online'","fields": [{"name": "Id"},{"name": "ArticleNumber"},{"name": "CreatedById"},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "CreatedDate","isYearEndFiscalYear": false},{"name": "OwnerId"},{"name": "PublishStatus"},{"name": "IsLatestVersion"},{"name": "IsVisibleInApp"},{"name": "IsVisibleInCsp"},{"name": "IsVisibleInPkb"},{"name": "IsVisibleInPrm"},{"name": "KnowledgeArticleId"},{"name": "Title"},{"name": "VersionNumber","type": "Text"}]}},"Handle_Only_Event_Activities": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "IsActivity","saqlExpression": "case when 'Case.Id' is null then \"No\" else \"Yes\" end","label": "Is Activity","type": "Text"},{"name": "IsClosed","saqlExpression": "case when 'Case.CurrentDate_sec_epoch' > 'EndDateTime_sec_epoch' then \"Completed\" else \"Open\" end","label": "Is Closed","type": "Text"}],"source": "Join_EventOwner_Case"}},"Compute_Extract_Task": {"action": "computeRelative","parameters": {"partitionBy": ["WhatId"],"orderBy": [{"name": "LastModifiedDate","direction": "asc"}],"source": "Extract_Task","computedFields": [{"expression": {"sourceField": "LastModifiedDate","default": "current()","offset": "first()"},"name": "TaskLastModifiedDate","description": "TaskLastModifiedDate","label": "TaskLastModifiedDate"}]}},"Extract_User": {"action": "sfdcDigest","parameters": {"object": "user","fields": [{"name": "CallCenterId"},{"name": "Name"},{"name": "UserRoleId"},{"name": "Id"}]}},"Join_CaseAccountContactUserUserRoleCaseArticle": {"action": "augment","parameters": {"right": "Join_CaseArticleKnowledge_User","right_select": ["ArticleVersionNumber","CaseId","CreatedDate","User.Name"],"right_key": ["CaseId"],"left": "Join_CaseAccountContactUserUserRole","left_key": ["Id"],"relationship": "CaseArticle"}},"Join_CaseAccountContactUserUserRoleRecordType": {"action": "augment","parameters": {"right": "Extract_RecordTypes","right_select": ["Name"],"right_key": ["Id"],"left": "Handle_Null_Attached_Articles","left_key": ["RecordTypeId"],"relationship": "RecordType"}},"Register_Knowledge": {"action": "sfdcRegister","parameters": {"alias": "ServiceKnowledge","name": "ServiceKnowledge","source": "computeKnowledgeDraftStatusAndChannelField"}},"Extract_Case": {"action": "sfdcDigest","parameters": {"object": "case","fields": [{"name": "CSAT__c","type": "Text"},{"name": "Duration__c"},{"name": "AccountId"},{"name": "ContactId"},{"name": "OwnerId"},{"name": "Id"},{"defaultValue": "N/A","name": "Origin"},{"defaultValue": "N/A","name": "Reason"},{"defaultValue": "N/A","name": "Type"},{"name": "IsClosed"},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "ClosedDate","isYearEndFiscalYear": false},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "CreatedDate","isYearEndFiscalYear": false},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "LastModifiedDate","isYearEndFiscalYear": false},{"name": "IsEscalated"},{"name": "First_Contact_Close__c"},{"defaultValue": "N/A","name": "Type_of_Support__c"},{"defaultValue": "N/A","name": "Status"},{"name": "MilestoneStatus"},{"defaultValue": "N/A","name": "Product_Name__c"},{"defaultValue": "N/A","name": "Priority"},{"name": "CaseNumber"},{"defaultValue": "N/A","name": "RecordTypeId"},{"name": "DB_Hours__c"}]}},"Join_CaseAccountContactUser": {"action": "augment","parameters": {"right": "Append_Queue_User","right_select": ["CallCenterId","Name","Id","UserRoleId","Type"],"right_key": ["Id"],"left": "Join_CaseAccountContact","left_key": ["OwnerId"],"relationship": "Owner"}},"Join_OpportunityRecordTypeAccount": {"action": "augment","parameters": {"right": "Extract_Account","right_select": ["Id","Name","BillingState","Industry"],"right_key": ["Id"],"left": "Handle_Null_Opportunity_RecordType","left_key": ["AccountId"],"relationship": "Account"}},"Join_EventOwner_Case": {"action": "augment","parameters": {"right": "Handle_Null_RecordType","right_select": ["Id","Origin","Reason","Type","IsClosed","ClosedDate","CreatedDate","Type_of_Support__c","Status","Product_Name__c","Priority","CaseNumber","RecordType.Name","Account.Name","Duration__c","CurrentDate","Role.Name"],"right_key": ["Id"],"left": "Join_EventOwner","left_key": ["WhatId"],"relationship": "Case"}},"Transform_Filter_Calls": {"action": "filter","parameters": {"filter": "IsActivity:EQ:Yes","source": "Handle_Only_Task_Activities"}},"computeKnowledgeCitationFlag": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "isAttachedByOwner","saqlExpression": "case when 'CreatedById' == 'Article.CreatedById' then \"true\" else \"false\" end","label": "is Attached By Owner?","type": "Text"}],"source": "Join_CaseArticleKnowledge_User_Case_Knowledge"}},"compute_CaseHistory_DatePrevious_Owner": {"action": "computeRelative","parameters": {"partitionBy": ["CaseId__c"],"orderBy": [{"name": "PDW_CreatedDate__c","direction": "asc"}],"source": "Extract_CaseHistory_Owner","computedFields": [{"expression": {"sourceField": "PDW_CreatedDate__c","default": "3000-01-01T00:00:00.000Z","offset": "next()"},"name": "tempValidToDate","description": "ValidToDate","label": "ValidToDate"},{"expression": {"sourceField": "PDW_CreatedDate__c","default": "current()","offset": "current()"},"name": "tempValidFromDate","description": "ValidFromDate","label": "ValidFromDate"},{"expression": {"sourceField": "PDW_CreatedDate__c","default": null,"offset": "next()"},"name": "tempCreatedDateNext","description": "Next Created Date","label": "Next CreatedDate"},{"expression": {"sourceField": "PDW_CreatedDate__c","default": null,"offset": "previous()"},"name": "tempCreatedDatePrev","description": "Previous Created Date","label": "Previous CreatedDate"}]}},"Handle_Null_Attached_Articles": {"action": "dim2mea","parameters": {"dimension": "CaseArticle.ArticleVersionNumber","measure": "ArticleVersion","measureDefault": "0","measureType": "long","source": "Join_CaseAccountContactUserUserRoleCaseArticle"}},"Extract_Queue": {"action": "sfdcDigest","parameters": {"object": "group","fields": [{"name": "Id"},{"name": "Name"}]}},"Case_CSAT_Mea": {"action": "dim2mea","parameters": {"dimension": "CSAT__c","measure": "CSAT","measureDefault": "-999","measureType": "long","source": "compute_CalculatedCaseDuration"}},"Join_CaseHistory_NewOwner": {"action": "augment","parameters": {"right": "Join_CaseHistory_Queue_User_UserRole","right_select": ["CallCenterId","Name","Id","Role.Name","Type"],"right_key": ["Id"],"left": "Join_CaseHistory_OldOwner","left_key": ["NewOwner"],"relationship": "NewOwner"}},"Extract_Knowledge_ViewStat": {"action": "sfdcDigest","parameters": {"object": "faq__viewstat","fields": [{"name": "Channel"},{"name": "ParentId"},{"name": "ViewCount"},{"name": "NormalizedScore"}]}},"Handle_Null_RecordType": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "RecordTypeName","saqlExpression": "case when RecordTypeId is null then \"N/A\" else 'RecordType.Name' end","label": "Case Record Type","type": "Text"}],"source": "Join_CaseAccountContactUserUserRoleRecordType"}},"computeJoin_ServiceCaseTaskEvent": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"defaultValue": "0","precision": 18,"name": "sum_last_activity","saqlExpression": "case when ('Task.TaskLastModifiedDate_sec_epoch' > 'Event.EventLastModifiedDate_sec_epoch' && 'Task.TaskLastModifiedDate_sec_epoch' >= 'LastModifiedDate_sec_epoch') then  ('CurrentDate_sec_epoch' - 'Task.TaskLastModifiedDate_sec_epoch')/86400 when ('Event.EventLastModifiedDate_sec_epoch' > 'Task.TaskLastModifiedDate_sec_epoch' && 'Event.EventLastModifiedDate_sec_epoch' >= 'LastModifiedDate_sec_epoch') then ('CurrentDate_sec_epoch' - 'Event.EventLastModifiedDate_sec_epoch')/86400  when ('LastModifiedDate_sec_epoch' >= 'Task.TaskLastModifiedDate_sec_epoch' && 'LastModifiedDate_sec_epoch' >= 'Event.EventLastModifiedDate_sec_epoch') then ('CurrentDate_sec_epoch' - 'LastModifiedDate_sec_epoch')/86400  else ('CurrentDate_sec_epoch' - 'LastModifiedDate_sec_epoch')/86400 end","scale": 2,"label": "Last LastModifiedDate","type": "Numeric"},{"defaultValue": "0","precision": 18,"name": "TaskLastModifiedDate_sec_epoch","saqlExpression": "'Task.TaskLastModifiedDate_sec_epoch'","scale": 2,"label": "TaskLastModifiedDate_sec_epoch","type": "Numeric"},{"defaultValue": "0","precision": 18,"name": "EventLastModifiedDate_sec_epoch","saqlExpression": "'Event.EventLastModifiedDate_sec_epoch'","scale": 2,"label": "EventLastModifiedDate_sec_epoch","type": "Numeric"},{"defaultValue": "0","precision": 18,"name": "LastLastModifiedDate_sec_epoch","saqlExpression": "'LastModifiedDate_sec_epoch'","scale": 2,"label": "LastLastModifiedDate_sec_epoch","type": "Numeric"}],"source": "Join_ServiceCaseTaskEvent"}},"compute_CurrentDateForCase": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"format": "yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","name": "CurrentDate","saqlExpression": "now()","label": "CurrentDate","type": "Date"}],"source": "Extract_Case"}},"Register_EventOwner_Case": {"action": "sfdcRegister","parameters": {"alias": "ServiceEvent","name": "ServiceEvent","SFDCtoken": "SFDCtoken","source": "Filter_Event_Calls"}},"Join_Append_Knowledge__kav_dataCategory": {"action": "augment","parameters": {"right": "Extract_Knowledge_DataCategory","right_select": ["DataCategoryName","DataCategoryGroupName"],"right_key": ["ParentId"],"left": "Append_Knowledge_kav","left_key": ["Id"],"operation": "LookupMultiValue","relationship": "DataCategory"}},"Extract_Knowledge_ka": {"action": "sfdcDigest","parameters": {"object": "faq__ka","fields": [{"name": "Id"},{"name": "ArticleNumber"},{"name": "CaseAssociationCount"},{"name": "CreatedById"},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "CreatedDate","isYearEndFiscalYear": false},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "FirstPublishedDate","isYearEndFiscalYear": false},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "LastPublishedDate","isYearEndFiscalYear": false},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "LastReferencedDate","isYearEndFiscalYear": false},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "LastViewedDate","isYearEndFiscalYear": false},{"name": "LastModifiedById"}]}},"Handle_Null_Opportunity_RecordType": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "RecordTypeName","saqlExpression": "case when RecordTypeId is null then \"N/A\" else 'RecordType.Name' end","label": "Opportunity Record Type","type": "Text"}],"source": "Join_OpportunityRecordType"}},"Add_Fields_To_User": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "Type","saqlExpression": "\"User\"","label": "Type","type": "Text"}],"source": "Extract_User"}},"Join_OpportunityRecordTypeAccountCase": {"action": "augment","parameters": {"right": "compute_CalculatedCaseDuration","right_select": ["Id","CaseNumber","IsEscalated","Priority"],"right_key": ["AccountId"],"left": "Join_OpportunityRecordTypeAccount","left_key": ["AccountId"],"relationship": "Case"}},"Join_Append_Knowledge__ka_kav_dataCategory_ViewStat": {"action": "augment","parameters": {"right": "Extract_Knowledge_ViewStat","right_select": ["Channel","ViewCount","NormalizedScore"],"right_key": ["ParentId"],"left": "Join_Append_Knowledge__ka_kav_dataCategory","left_key": ["Id"],"relationship": "ViewStat"}},"Add_Fields_To_Queue": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "CallCenterId","saqlExpression": "\"000000000000000\"","label": "CallCenterId","type": "Text"},{"name": "Type","saqlExpression": "\"Queue\"","label": "Type","type": "Text"},{"name": "UserRoleId","saqlExpression": "\"000000000000000\"","label": "UserRoleId","type": "Text"}],"source": "Extract_Queue"}},"Register_Opportunity": {"action": "sfdcRegister","parameters": {"alias": "ServiceOpportunity","name": "ServiceOpportunities","SFDCtoken": "SFDCtoken","source": "Join_OpportunityRecordTypeAccountCase"}},"Join_Append_Knowledge__ka_kav_dataCategory_ViewStat_VoteStat_User": {"action": "augment","parameters": {"right": "Extract_User","right_select": ["Name"],"right_key": ["Id"],"left": "Join_Append_Knowledge__ka_kav_dataCategory_ViewStat_VoteStat","left_key": ["CreatedById"],"relationship": "User"}},"Register_ServiceCaseHistory": {"action": "sfdcRegister","parameters": {"alias": "ServiceCaseHistory","name": "ServiceCaseHistory","source": "Join_CaseHistory_NewOwner"}},"Join_CaseArticleKnowledge_User_Case": {"action": "augment","parameters": {"right": "compute_CalculatedCaseDuration","right_select": ["Product_Name__c","Reason","Status","Type_of_Support__c","Type"],"right_key": ["Id"],"left": "Join_CaseArticleKnowledge_User","left_key": ["CaseId"],"relationship": "Case"}},"Extract_Knowledge_kav_archived": {"action": "sfdcDigest","parameters": {"object": "faq__kav","complexFilterConditions": "language = 'en_US' and PublishStatus='Archived'","fields": [{"name": "Id"},{"name": "ArticleNumber"},{"name": "CreatedById"},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "CreatedDate","isYearEndFiscalYear": false},{"name": "OwnerId"},{"name": "PublishStatus"},{"name": "IsLatestVersion"},{"name": "IsVisibleInApp"},{"name": "IsVisibleInCsp"},{"name": "IsVisibleInPkb"},{"name": "IsVisibleInPrm"},{"name": "KnowledgeArticleId"},{"name": "Title"},{"name": "VersionNumber","type": "Text"}]}},"Extract_CaseHistory_Owner": {"action": "sfdcDigest","parameters": {"object": "srwhistory__c","complexFilterConditions": "PDW_CreatedDate__c >= LAST_N_MONTHS:18 and Field__c ='Owner'","fields": [{"name": "CaseId__c"},{"name": "CreatedById"},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "PDW_CreatedDate__c","isYearEndFiscalYear": false},{"name": "Field__c"},{"name": "Id"},{"name": "NewValue__c"},{"name": "OldValue__c"}]}},"Extract_Task": {"action": "sfdcDigest","parameters": {"object": "task","fields": [{"name": "Id"},{"name": "CallObject"},{"name": "CallDurationInSeconds"},{"defaultValue": "N/A","name": "CallDisposition"},{"defaultValue": "N/A","name": "CallType"},{"name": "OwnerId"},{"defaultValue": "N/A","name": "Status"},{"defaultValue": "N/A","name": "Priority"},{"name": "IsClosed"},{"name": "IsArchived"},{"defaultValue": "N/A","name": "TaskSubtype"},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "CreatedDate","isYearEndFiscalYear": false},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "ActivityDate","isYearEndFiscalYear": false},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "LastModifiedDate","isYearEndFiscalYear": false},{"defaultValue": "N/A","name": "Subject"},{"name": "WhatId"}]}},"Filter_Task_Calls": {"action": "filter","parameters": {"filter": "IsActivity:EQ:Yes","source": "Handle_Only_Task_Activities"}},"Join_EventOwner": {"action": "augment","parameters": {"right": "Extract_User","right_select": ["Name","Id","UserRoleId"],"right_key": ["Id"],"left": "Compute_Extract_Event","left_key": ["OwnerId"],"relationship": "Owner"}},"Join_CaseArticleKnowledge_User_Case_Knowledge": {"action": "augment","parameters": {"right": "computeKnowledgeDraftStatusAndChannelField","right_select": ["ArticleVersion.Title","ArticleVersion.PublishStatus","ArticleVersion.VersionNumber","ArticleVersion.IsVisibleInApp","ArticleVersion.IsVisibleInCsp","ArticleVersion.IsVisibleInPkb","ArticleVersion.IsVisibleInPrm","ArticleVersion.DataCategory.DataCategoryName","ArticleVersion.DataCategory.DataCategoryGroupName","User.Name","CreatedById"],"right_key": ["Id"],"left": "Join_CaseArticleKnowledge_User_Case","left_key": ["KnowledgeArticleId"],"relationship": "Article"}},"computeKnowledgeDraftStatusAndChannelField": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "IsDraft","saqlExpression": "case when 'ArticleVersion.Id' is null then \"true\" else \"false\" end","label": "Is Draft","type": "Text"},{"name": "ChannelList","saqlExpression": "case when ('ArticleVersion.IsVisibleInApp' == \"false\" && 'ArticleVersion.IsVisibleInPrm' == \"false\" && 'ArticleVersion.IsVisibleInCsp' == \"false\" && 'ArticleVersion.IsVisibleInPkb' == \"true\" ) then \"Public\" when ('ArticleVersion.IsVisibleInApp' == \"false\" && 'ArticleVersion.IsVisibleInPrm' == \"false\" && 'ArticleVersion.IsVisibleInCsp' == \"true\" && 'ArticleVersion.IsVisibleInPkb' == \"false\" ) then \"Customer\" when ('ArticleVersion.IsVisibleInApp' == \"false\" && 'ArticleVersion.IsVisibleInPrm' == \"false\" && 'ArticleVersion.IsVisibleInCsp' == \"true\" && 'ArticleVersion.IsVisibleInPkb' == \"true\" ) then \"Customer;Public\" when ('ArticleVersion.IsVisibleInApp' == \"false\" && 'ArticleVersion.IsVisibleInPrm' == \"true\" && 'ArticleVersion.IsVisibleInCsp' == \"false\" && 'ArticleVersion.IsVisibleInPkb' == \"false\" ) then \"Parter\" when ('ArticleVersion.IsVisibleInApp' == \"false\" && 'ArticleVersion.IsVisibleInPrm' == \"true\" && 'ArticleVersion.IsVisibleInCsp' == \"false\" && 'ArticleVersion.IsVisibleInPkb' == \"true\" ) then \"Parter;Public\" when ('ArticleVersion.IsVisibleInApp' == \"false\" && 'ArticleVersion.IsVisibleInPrm' == \"true\" && 'ArticleVersion.IsVisibleInCsp' == \"true\" && 'ArticleVersion.IsVisibleInPkb' == \"false\" ) then \"Parter;Customer\"    when ('ArticleVersion.IsVisibleInApp' == \"false\" && 'ArticleVersion.IsVisibleInPrm' == \"true\" && 'ArticleVersion.IsVisibleInCsp' == \"true\" && 'ArticleVersion.IsVisibleInPkb' == \"true\" ) then \"Parter;Customer;Public\" when ('ArticleVersion.IsVisibleInApp' == \"true\" && 'ArticleVersion.IsVisibleInPrm' == \"false\" && 'ArticleVersion.IsVisibleInCsp' == \"false\" && 'ArticleVersion.IsVisibleInPkb' == \"false\" ) then \"Internal\" when ('ArticleVersion.IsVisibleInApp' == \"true\" && 'ArticleVersion.IsVisibleInPrm' == \"false\" && 'ArticleVersion.IsVisibleInCsp' == \"false\" && 'ArticleVersion.IsVisibleInPkb' == \"true\" ) then \"Internal;Public\" when ('ArticleVersion.IsVisibleInApp' == \"true\" && 'ArticleVersion.IsVisibleInPrm' == \"false\" && 'ArticleVersion.IsVisibleInCsp' == \"true\" && 'ArticleVersion.IsVisibleInPkb' == \"false\" ) then \"Internal;Customer\" when ('ArticleVersion.IsVisibleInApp' == \"true\" && 'ArticleVersion.IsVisibleInPrm' == \"false\" && 'ArticleVersion.IsVisibleInCsp' == \"true\" && 'ArticleVersion.IsVisibleInPkb' == \"true\" ) then \"Internal;Customer;Public\" when ('ArticleVersion.IsVisibleInApp' == \"true\" && 'ArticleVersion.IsVisibleInPrm' == \"true\" && 'ArticleVersion.IsVisibleInCsp' == \"false\" && 'ArticleVersion.IsVisibleInPkb' == \"false\" ) then \"Internal;Parter\" when ('ArticleVersion.IsVisibleInApp' == \"true\" && 'ArticleVersion.IsVisibleInPrm' == \"true\" && 'ArticleVersion.IsVisibleInCsp' == \"false\" && 'ArticleVersion.IsVisibleInPkb' == \"true\" ) then \"Internal;Parter;Public\" when ('ArticleVersion.IsVisibleInApp' == \"true\" && 'ArticleVersion.IsVisibleInPrm' == \"true\" && 'ArticleVersion.IsVisibleInCsp' == \"true\" && 'ArticleVersion.IsVisibleInPkb' == \"false\" ) then \"Internal;Parter;Customer\" when ('ArticleVersion.IsVisibleInApp' == \"true\" && 'ArticleVersion.IsVisibleInPrm' == \"true\" && 'ArticleVersion.IsVisibleInCsp' == \"true\" && 'ArticleVersion.IsVisibleInPkb' == \"true\" ) then \"Internal;Parter;Customer;Public\" end","label": "Channel List","type": "Text"}],"source": "Join_Append_Knowledge__ka_kav_dataCategory_ViewStat_VoteStat_User"}},"Relabel_CustomCaseHistory": {"action": "computeExpression","parameters": {"computedFields": [{"name": "CaseId","saqlExpression": "'CaseId__c'","label": "CaseId","type": "Text"},{"name": "CreatedDate","saqlExpression": "toDate('PDW_CreatedDate__c_sec_epoch')","format": "yyyy-MM-dd hh:mm:ss a","label": "CreatedDate","type": "Date"},{"name": "NewValue","saqlExpression": "'NewValue__c'","label": "NewValue","type": "Text"},{"name": "OldValue","saqlExpression": "'OldValue__c'","label": "OldValue","type": "Text"},{"name": "Field","saqlExpression": "'Field__c'","label": "Field","type": "Text"},{"name": "CaseHistoryId","saqlExpression": "'Id'","label": "CaseHistoryId","type": "Text"},{"name": "CaseHistoryCreatedById","saqlExpression": "'CreatedById'","label": "CaseHistoryCreatedById","type": "Text"},{"name": "ValidToDate","saqlExpression": "toDate('tempValidToDate_sec_epoch')","format": "yyyy-MM-dd hh:mm:ss a","label": "ValidToDate","type": "Date"},{"name": "ValidFromDate","saqlExpression": "toDate('tempValidFromDate_sec_epoch')","format": "yyyy-MM-dd hh:mm:ss a","label": "ValidFromDate","type": "Date"},{"name": "CreatedDateNext","saqlExpression": "toDate('tempCreatedDateNext_sec_epoch')","format": "yyyy-MM-dd hh:mm:ss a","label": "CreatedDateNext","type": "Date"},{"name": "CreatedDatePrev","saqlExpression": "toDate('tempCreatedDatePrev_sec_epoch')","format": "yyyy-MM-dd hh:mm:ss a","label": "CreatedDatePrev","type": "Date"}],"source": "Append_CaseHistory"}},"Join_Append_Knowledge__ka_kav_dataCategory_ViewStat_VoteStat": {"action": "augment","parameters": {"right": "Extract_Knowledge_VoteStat","right_select": ["Channel","NormalizedScore"],"right_key": ["ParentId"],"left": "Join_Append_Knowledge__ka_kav_dataCategory_ViewStat","left_key": ["Id"],"relationship": "VoteStat"}},"Join_CaseArticleKnowledge_User": {"action": "augment","parameters": {"right": "Extract_User","right_select": ["Id","Name"],"right_key": ["Id"],"left": "Extract_CaseArticleKnowledge","left_key": ["CreatedById"],"relationship": "User"}},"Append_Queue_User": {"action": "append","parameters": {"sources": ["Add_Fields_To_Queue","Add_Fields_To_User"]}},"Extract_Knowledge_DataCategory": {"action": "sfdcDigest","parameters": {"object": "faq__datacategoryselection","fields": [{"name": "DataCategoryGroupName"},{"name": "DataCategoryName"},{"name": "ParentId"}]}},"Extract_CaseArticleKnowledge": {"action": "sfdcDigest","parameters": {"object": "casearticle","fields": [{"name": "ArticleVersionNumber","type": "Text"},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "CreatedDate","isYearEndFiscalYear": false},{"name": "CaseId"},{"name": "CreatedById"},{"name": "KnowledgeArticleId"},{"name": "IsSharedByEmail"}]}},"Join_Append_Knowledge__ka_kav_dataCategory": {"action": "augment","parameters": {"right": "Join_Append_Knowledge__kav_dataCategory","right_select": ["CreatedById","CreatedDate","OwnerId","PublishStatus","IsLatestVersion","IsVisibleInApp","IsVisibleInCsp","IsVisibleInPkb","IsVisibleInPrm","Title","VersionNumber","Id","DataCategory.DataCategoryName","DataCategory.DataCategoryGroupName"],"right_key": ["KnowledgeArticleId"],"left": "Extract_Knowledge_ka","left_key": ["Id"],"relationship": "ArticleVersion"}},"Extract_Knowledge_VoteStat": {"action": "sfdcDigest","parameters": {"object": "faq__votestat","fields": [{"name": "Channel"},{"name": "ParentId"},{"name": "NormalizedScore"}]}},"compute_CaseHistory_CurrentDate": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"format": "yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","name": "CurrentDate","saqlExpression": "now()","label": "CurrentDate","type": "Date"}],"source": "Join_CaseHistory_Case"}},"Extract_CaseHistory_Status": {"action": "sfdcDigest","parameters": {"object": "srwhistory__c","complexFilterConditions": "PDW_CreatedDate__c >= LAST_N_MONTHS:18 and Field__c ='Status'","fields": [{"name": "CaseId__c"},{"name": "CreatedById"},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "PDW_CreatedDate__c","isYearEndFiscalYear": false},{"name": "Field__c"},{"name": "Id"},{"name": "NewValue__c"},{"name": "OldValue__c"}]}},"Filter_Event_Calls": {"action": "filter","parameters": {"filter": "IsActivity:EQ:Yes","source": "Handle_Only_Event_Activities"}},"compute_CalculatedCaseDuration": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"defaultValue": "0","precision": 18,"name": "DurationCalculatedField","saqlExpression": "case  when ('IsClosed' == \"true\") then ('ClosedDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400   else ('CurrentDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400  end","scale": 2,"label": "Case Duration","type": "Numeric"}],"source": "compute_CurrentDateForCase"}},"Join_CaseHistory_Queue_User_UserRole": {"action": "augment","parameters": {"right": "Extract_UserRole","right_select": ["Name"],"right_key": ["Id"],"left": "Append_Queue_User","left_key": ["UserRoleId"],"relationship": "Role"}},"Register_KnowledgeAttached": {"action": "sfdcRegister","parameters": {"alias": "ServiceKnowledgeAttached","name": "ServiceKnowledgeAttached","source": "computeKnowledgeCitationFlag"}},"Join_OpportunityRecordType": {"action": "augment","parameters": {"right": "Extract_RecordTypes","right_select": ["Name"],"right_key": ["Id"],"left": "Extract_Opportunity","left_key": ["RecordTypeId"],"relationship": "RecordType"}},"compute_CaseHistory_DatePrevious_Status": {"action": "computeRelative","parameters": {"partitionBy": ["CaseId__c"],"orderBy": [{"name": "PDW_CreatedDate__c","direction": "asc"}],"source": "Extract_CaseHistory_Status","computedFields": [{"expression": {"sourceField": "PDW_CreatedDate__c","default": "3000-01-01T00:00:00.000Z","offset": "next()"},"name": "tempValidToDate","description": "ValidToDate","label": "ValidToDate"},{"expression": {"sourceField": "PDW_CreatedDate__c","default": "current()","offset": "current()"},"name": "tempValidFromDate","description": "ValidFromDate","label": "ValidFromDate"},{"expression": {"sourceField": "PDW_CreatedDate__c","default": null,"offset": "next()"},"name": "tempCreatedDateNext","description": "Next Created Date","label": "Next CreatedDate"},{"expression": {"sourceField": "PDW_CreatedDate__c","default": null,"offset": "previous()"},"name": "tempCreatedDatePrev","description": "Previous Created Date","label": "Previous CreatedDate"}]}},"Append_Knowledge_kav": {"action": "append","parameters": {"sources": ["Extract_Knowledge_kav_online","Extract_Knowledge_kav_archived"]}},"Extract_RecordTypes": {"action": "sfdcDigest","parameters": {"object": "recordtype","fields": [{"name": "Name"},{"name": "Id"}]}},"Extract_Account": {"action": "sfdcDigest","parameters": {"object": "account","fields": [{"name": "Id"},{"name": "Name"},{"defaultValue": "N/A","name": "BillingState"},{"defaultValue": "N/A","name": "Industry"}]}},"Join_TaskOwner": {"action": "augment","parameters": {"right": "Extract_User","right_select": ["Name","Id","UserRoleId"],"right_key": ["Id"],"left": "Compute_Extract_Task","left_key": ["OwnerId"],"relationship": "Owner"}},"Join_ServiceCaseTaskEvent": {"action": "augment","parameters": {"right": "Compute_Extract_Event","right_select": ["EventLastModifiedDate"],"right_key": ["WhatId"],"left": "Join_ServiceCaseServiceTask","left_key": ["Id"],"relationship": "Event"}},"Extract_UserRole": {"action": "sfdcDigest","parameters": {"object": "userrole","fields": [{"name": "Id"},{"name": "Name"},{"name": "ParentRoleId"},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "LastModifiedDate","isYearEndFiscalYear": false},{"name": "LastModifiedById"},{"name": "SystemModstamp"}]}},"Join_CaseAccountContactUserUserRole": {"action": "augment","parameters": {"right": "Extract_UserRole","right_select": ["Name","ParentRoleId"],"right_key": ["Id"],"left": "Join_CaseAccountContactUser","left_key": ["Owner.UserRoleId"],"relationship": "Role"}},"Compute_Extract_Event": {"action": "computeRelative","parameters": {"partitionBy": ["WhatId"],"orderBy": [{"name": "LastModifiedDate","direction": "asc"}],"source": "Extract_Event","computedFields": [{"expression": {"sourceField": "LastModifiedDate","default": "current()","offset": "first()"},"name": "EventLastModifiedDate","description": "EventLastModifiedDate","label": "EventLastModifiedDate"}]}},"compute_CaseHistory_OldNewStatus": {"action": "computeExpression","parameters": {"mergeWithSource": true,"computedFields": [{"name": "NewStatus","saqlExpression": "case when 'Field' == \"created\" then \"Created\" when 'Field' == \"Status\" then 'NewValue' else\"NA\" end ","label": "New Status","type": "Text"},{"name": "OldStatus","saqlExpression": "case when 'Field' == \"closed\" then \"Closed\" when 'Field' == \"Status\" then 'OldValue' else \"NA\" end ","label": "Old Status","type": "Text"},{"defaultValue": "N/A","name": "NewOwner","saqlExpression": "case when 'Field' == \"Owner\" then 'NewValue' else\"NA\" end ","label": "New Owner","type": "Text"},{"defaultValue": "N/A","name": "OldOwner","saqlExpression": "case when 'Field' == \"Owner\" then 'OldValue' else \"NA\" end ","label": "Old Owner","type": "Text"},{"defaultValue": "0","precision": 18,"name": "DateDiffOld","saqlExpression": "case when ('CreatedDatePrev' is null) then ('CreatedDate_sec_epoch' - 'Case.CreatedDate_sec_epoch')/86400  else ('CreatedDate_sec_epoch' - 'CreatedDatePrev_sec_epoch')/86400 end","scale": 2,"label": "Date Diff Old","type": "Numeric"},{"defaultValue": "0","precision": 18,"name": "DateDiffNew","saqlExpression": "case  when ('Case.IsClosed' == \"true\" && 'CreatedDateNext' is null && CreatedDate <= 'Case.ClosedDate') then ('Case.ClosedDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400   when ('Case.IsClosed' == \"true\" &&  CreatedDate > 'Case.ClosedDate') then 0 when 'CreatedDateNext' is null then ('CurrentDate_sec_epoch' -'CreatedDate_sec_epoch')/86400 else ('CreatedDateNext_sec_epoch' - 'CreatedDate_sec_epoch')/86400 end","scale": 2,"label": "Date Diff New","type": "Numeric"},{"defaultValue": "false","name": "ChangeAfterCloseDate","saqlExpression": "case  when ('Field' == \"Owner\" && 'CreatedDate' > 'Case.ClosedDate') then \"true\"  else \"false\" end ","label": "Change After CloseDate","type": "Text"},{"defaultValue": "false","name": "IsLastChange","saqlExpression": "case when ('Case.ClosedDate' is null && 'ValidToDate' == \"3000-01-01T00:00:00.000Z\") then \"true\" when ('ValidFromDate' <= 'Case.ClosedDate' && 'ValidToDate' > 'Case.ClosedDate') then \"true\" else \"false\" end ","label": "Last Change","type": "Text"}],"source": "compute_CaseHistory_CurrentDate"}},"Extract_Event": {"action": "sfdcDigest","parameters": {"object": "event","fields": [{"name": "OwnerId"},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "CreatedDate","isYearEndFiscalYear": false},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "LastModifiedDate","isYearEndFiscalYear": false},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "ActivityDate","isYearEndFiscalYear": false},{"fiscalMonthOffset": 0,"firstDayOfWeek": "0","name": "EndDateTime","isYearEndFiscalYear": false},{"defaultValue": "N/A","name": "Subject"},{"name": "ShowAs"},{"name": "DurationInMinutes"},{"defaultValue": "N/A","name": "EventSubtype"},{"name": "WhatId"}]}},"Join_TaskOwner_Case": {"action": "augment","parameters": {"right": "Handle_Null_RecordType","right_select": ["Id","Origin","Reason","Type","IsClosed","ClosedDate","CreatedDate","Type_of_Support__c","Status","Product_Name__c","Priority","CaseNumber","RecordType.Name","Account.Name","Duration__c","Role.Name"],"right_key": ["Id"],"left": "Join_TaskOwner","left_key": ["WhatId"],"relationship": "Case"}},"Register_Case": {"action": "sfdcRegister","parameters": {"alias": "ServiceCase1","name": "ServiceCase","SFDCtoken": "SFDCtoken","source": "Handle_Null_RecordType"}},"Append_CaseHistory": {"action": "append","parameters": {"sources": ["compute_CaseHistory_DatePrevious_Status","compute_CaseHistory_DatePrevious_Owner"]}}}
